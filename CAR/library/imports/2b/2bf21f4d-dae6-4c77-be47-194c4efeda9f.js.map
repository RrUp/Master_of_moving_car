{"version":3,"sources":["../../../../../../../assets/wechat_game_module-master/exp/GameBox/Script/assets/wechat_game_module-master/exp/GameBox/Script/exported-GameBox.js"],"names":["fileSystemManager","require","KEY","VERSION","cc","Class","extends","Component","properties","itemBox","Node","gamePrefab","Prefab","gamePrefabScript","canvas","waiting","layer","version","Label","btn","init","gameName","miniGameList","loadString","sys","localStorage","getItem","length","setItem","JSON","stringify","CC_WECHATGAME","startP","v2","winSize","width","endP","position","string","state","getComponent","initItemBox","initJson","windowSize","height","console","log","left","self","urlPath","loader","load","err","res","addList","serverString","newlist","initList","UpdateLocal","serverData","parse","localData","array","Object","keys","data","forEach","element","logo","removeFile","url","success","title","qrcode","list","k","wx","getSystemInfo","platform","index","appid","node","instantiate","name","spriteFrame","style","btnCallback","bind","parent","getFile","remoteUrl","texture","SpriteFrame","setSpriteFrame","fail","default_icon_url_head","type","desc","navigateToMiniProgram","appId","path","errMsg","indexOf","showQR","previewImage","urls","show","first","callFunc","move","moveTo","finished","callback","setGameLogo","active","seq","sequence","runAction","hide","readBtn","showFile","clearLocsl","removeAllFile"],"mappings":"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","file":"exported-GameBox.js","sourceRoot":"../../../../../../../assets/wechat_game_module-master/exp/GameBox/Script","sourcesContent":["var fileSystemManager = require(\"WeChatFileSystemManager\");\nconst KEY = \"NewGameBox\";\nconst VERSION = \"1.0.1\";\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        itemBox: cc.Node,\n\n        gamePrefab: cc.Prefab,\n        gamePrefabScript: \"\",\n\n        canvas: cc.Node,\n        waiting: cc.Node,\n        layer: cc.Node,\n\n        version: cc.Label,\n\n        btn: cc.Node,\n\n        // gameBoxJson: cc.JsonAsset,\n\n    },\n\n    init: function (gameName) {\n\n        // this.miniGameList = [\n        //     \"wxd5a257d6ee2b8f91\",//飞机大作战\n        //     \"wx515f44394eab5985\",//切水果\n        //     \"wxf49b0a26d9405058\",//恋爱球球\n        //     \"wxea245f85c9673414\",//俄罗斯方块\n        //     \"wx08beeb18dc512c2f\",//消灭星星\n        //     \"wxc4e628aa7caa2c07\",//飞刀\n        //     \"wxd9589cd7117d0873\",//最囧\n        //     \"wx0af703a36035c60c\",//2048六角消除数字方块//\"wx40fb3563b8ac79b2\",//2048\n        //     \"wx6616ae605010e605\",//欢乐球球\n        //     \"wxac5820bc06a3a893\",//弹球弹一弹//\"wx528f5a9cd16be88a\"//贪吃蛇\n        // ];\n        this.miniGameList = {};\n\n        this.miniGameList[\"wxd5a257d6ee2b8f91\"] = true//飞机大作战\n        this.miniGameList[\"wx515f44394eab5985\"] = true//切水果\n        this.miniGameList[\"wxf49b0a26d9405058\"] = true//恋爱球球\n        this.miniGameList[\"wxea245f85c9673414\"] = true//俄罗斯方块\n        this.miniGameList[\"wx08beeb18dc512c2f\"] = true//消灭星星\n        this.miniGameList[\"wxc4e628aa7caa2c07\"] = true//飞刀\n        this.miniGameList[\"wxd9589cd7117d0873\"] = true//最囧\n        this.miniGameList[\"wx0af703a36035c60c\"] = true//2048六角消除数字方块//\"wx40fb3563b8ac79b2\",//2048\n        this.miniGameList[\"wx6616ae605010e605\"] = true//欢乐球球\n        this.miniGameList[\"wxac5820bc06a3a893\"] = true//弹球弹一弹//\"wx528f5a9cd16be88a\"//贪吃蛇\n\n        var loadString = cc.sys.localStorage.getItem(KEY);\n        if ((loadString == null) || (loadString.length == 0)) {\n            cc.sys.localStorage.setItem(KEY, JSON.stringify({}));\n        }\n\n        if (CC_WECHATGAME) {\n            fileSystemManager.init(\"NewGameBox\", gameName);\n        }\n\n        this.startP = cc.v2(- cc.winSize.width * 0.5 - 220, 50);\n        this.endP = cc.v2(this.canvas.width * 0.5 - cc.winSize.width * 0.5, 50);\n        this.canvas.position = this.startP;\n\n        this.version.string = \"V \" + VERSION;\n        this.state = \"close\";\n\n        this.btn = this.btn.getComponent(\"exported-Button\");\n        this.btn.init(this)\n\n        this.initItemBox();\n\n        this.initJson(gameName);\n\n    },\n\n    initItemBox: function () {\n        var windowSize = cc.winSize;\n        if (windowSize.width / windowSize.height >= 2.1) {\n            console.log(\"x\");\n            this.itemBox.getComponent(\"cc.Widget\").left = 120;\n        }\n\n    },\n\n    initJson: function (gameName) {\n        var self = this;\n        var urlPath = \"https://www.7cgames.cn/transfer.php?url=https://www.7cgames.cn/GameRes/7CGamesBoxWX/NewGameBox/7cgamesBoxData.json?\" + gameName;\n        // var urlPath = \"http://192.168.0.108/transfer.php?url=http://192.168.0.108/GameRes/7CGamesBoxWX/NewGameBox/7cgamesBoxData.json\";\n        cc.loader.load(urlPath, function (err, res) {\n            if (err)\n                console.log(err);\n            else {\n                // console.log(res);\n                self.addList(res);\n            }\n        });\n\n\n        // var json = this.gameBoxJson.json;\n        // // console.log(json);\n        // self.addList(JSON.stringify(json));\n    },\n\n    addList: function (res) {\n        var self = this;\n        self.serverString = res\n        self.loadString = cc.sys.localStorage.getItem(KEY);\n        self.newlist = {};\n\n        self.initList();\n        self.UpdateLocal();\n    },\n\n    UpdateLocal: function () {\n        console.log(\"整体更新本地\");\n\n        var serverData = JSON.parse(this.serverString);\n        var localData = JSON.parse(cc.sys.localStorage.getItem(KEY));\n\n        var array = Object.keys(localData);\n\n        console.log(\"本地个数：\", array.length);\n        console.log(\"服务器个数：\", serverData.data.length);\n\n        array.forEach(element => {\n            if (this.newlist[element]) {\n\n                if (this.newlist[element].logo != localData[element].logo) {\n                    if (CC_WECHATGAME) {\n                        fileSystemManager.removeFile({\n                            url: localData[element].logo,\n                            success: function () {\n                                console.log(\"删除成功\");\n                            },\n                        });\n                    } else {\n                        console.log(\"删除成功: \" + localData[element].title + \",logo\");\n                        console.log(\"删除成功: \" + localData[element].logo);\n\n                    }\n                }\n\n                if (this.newlist[element].qrcode != localData[element].qrcode) {\n                    if (CC_WECHATGAME) {\n                        fileSystemManager.removeFile({\n                            url: localData[element].qrcode,\n                            success: function () {\n                                console.log(\"删除成功\");\n                            },\n                        });\n                    } else {\n                        console.log(\"删除成功: \" + localData[element].title + \",qrcode\");\n                        console.log(\"删除成功: \" + localData[element].qrcode);\n\n                    }\n                }\n\n            } else {\n                console.log(\"不存在\");\n                console.log(\"删除旧的\" + localData[element].title + \"本地文件\");\n\n                if (CC_WECHATGAME) {\n                    fileSystemManager.removeFile({\n                        url: localData[element].logo,\n                        success: function () {\n                            console.log(\"删除成功\");\n                        },\n                    });\n                    fileSystemManager.removeFile({\n                        url: localData[element].qrcode,\n                        success: function () {\n                            console.log(\"删除成功\");\n                        },\n                    });\n                } else {\n                    console.log(\"删除成功: \" + localData[element].title + \"全部文件\");\n                }\n            }\n        });\n\n        console.log(\"整体更新完成\");\n        cc.sys.localStorage.setItem(KEY, JSON.stringify(this.newlist));\n\n    },\n\n    initList: function () {\n        var self = this;\n        var list = JSON.parse(this.serverString).data;\n\n        var length = list.length;\n        var k = false;\n        if (CC_WECHATGAME) {\n            wx.getSystemInfo({\n                success(res) {\n                    var platform = res.platform\n                    if (platform == \"ios\") {\n                        console.log(\"ios\");\n                        k = true;\n                    } else if (platform == \"android\") {\n                        console.log(\"android\");\n\n                    } else if (platform == \"devtools\") {\n                        console.log(\"devtools\");\n\n                    } else if (platform == \"web\") {\n                        console.log(\"web\");\n\n                    }\n                }\n            })\n        }\n\n        // length =10;\n        // k = true;\n\n\n        // list.forEach(element => {\n\n        // });\n\n        for (let index = 0; index < length; index++) {\n            const element = list[index];\n\n            // if(\"wx752f89793f11fd94\" == element.appid)\n            // console.log(\"ok???\");\n            if (k) {\n                if (this.miniGameList[element.appid]) {\n\n                } else {\n                    continue;\n                }\n            }\n\n            let node = cc.instantiate(self.gamePrefab);\n\n            node.getComponent(self.gamePrefabScript).init({\n                width: cc.winSize.width * 0.2,\n                name: element.title,\n                appid: element.appid,\n                spriteFrame: null,\n                style: element.style,\n                qrcode: element.qrcode,\n                btnCallback: self.btnCallback.bind(self),\n            });\n\n            node.parent = self.itemBox;\n\n            if (CC_WECHATGAME) {\n                fileSystemManager.getFile({\n                    url: element.logo,\n                    success: function (remoteUrl) {\n                        cc.loader.load(remoteUrl, function (err, texture) {\n\n                            var spriteFrame = new cc.SpriteFrame(texture);\n                            node.getComponent(self.gamePrefabScript).setSpriteFrame(spriteFrame);\n\n                        });\n                    },\n                    fail: function () {\n                        console.log(\"加载图片失败\");\n                    },\n                });\n            } else {\n                var default_icon_url_head = \"http://192.168.0.108/transfer.php?url=\";\n                var urlPath = default_icon_url_head + element.logo;\n                var url = { url: urlPath + \"?ass\", type: \"png\" };\n                // url = url.url+ \"?\"\n                console.log(url);\n                cc.loader.load(url, function (err, texture) {\n                    var spriteFrame = new cc.SpriteFrame(texture);\n                    node.getComponent(self.gamePrefabScript).setSpriteFrame(spriteFrame);\n                });\n            }\n\n            this.newlist[element.appid] = {\n                desc: element.desc,\n                title: element.title,\n                logo: element.logo,\n                qrcode: element.qrcode,\n            }\n        }\n\n    },\n\n\n    btnCallback: function (res) {\n        console.log(res);\n        var appid = res.appid;\n        var qrcode = res.qrcode;\n        var self = this;\n        // self.waiting.active = true;\n\n        if (CC_WECHATGAME) {\n            if (wx.navigateToMiniProgram) {\n\n                wx.navigateToMiniProgram({\n                    appId: appid,\n                    path: '',\n                    success() {\n                        console.log(\"打开成功\");\n\n                        // self.waiting.active = false;\n                    },\n                    fail: function (err) {\n                        console.log(err);\n\n                        if (err.errMsg.indexOf(\"fail cancel\") == -1) {\n                            self.showQR({\n                                qrcode: qrcode,\n                            });\n                        } else {\n                            // self.waiting.active = false;\n                        }\n                    },\n                });\n\n            } else {\n\n                console.log(\"navigateToMiniProgram 低版本适配\");\n\n                self.showQR({\n                    qrcode: qrcode,\n                });\n\n            }\n\n        } else {\n\n            // self.waiting.active = false;\n\n        }\n    },\n\n    showQR: function (res) {\n        var self = this;\n        fileSystemManager.getFile({\n            url: res.qrcode,\n            success: function (remoteUrl) {\n                wx.previewImage({\n                    urls: [remoteUrl],\n                    success: function () {\n                        // self.waiting.active = false;\n                        console.log(\"wei xin previewImage success....\");\n                    }\n                });\n            },\n            fail: function () {\n                console.log(\"加载图片失败\");\n                // self.waiting.active = false;\n            },\n        });\n    },\n\n\n\n    show: function (data) {\n\n        var self = this;\n        var first = cc.callFunc(function () {\n            // this.startPosition = this.canvas.position;\n\n            self.state = \"move\";\n        }, this);\n        var move = cc.moveTo(0.3, self.endP);\n        var finished = cc.callFunc(function () {\n            self.state = \"open\";\n\n\n            data.callback && data.callback();\n\n            if (data.appid) {\n                if (self.newlist[data.appid]) {\n                    this.layer.getComponent(\"exported-Layer\").init({\n                        appid: data.appid,\n                        title: self.newlist[data.appid].title,\n                        desc: self.newlist[data.appid].desc,\n                        qrcode: self.newlist[data.appid].qrcode,\n                        callback: self.btnCallback.bind(self),\n                    });\n\n                    if (CC_WECHATGAME) {\n                        fileSystemManager.getFile({\n                            url: self.newlist[data.appid].logo,\n                            success: function (remoteUrl) {\n                                cc.loader.load(remoteUrl, function (err, texture) {\n\n                                    var spriteFrame = new cc.SpriteFrame(texture);\n                                    self.layer.getComponent(\"exported-Layer\").setGameLogo(spriteFrame);\n\n                                });\n                            },\n                            fail: function () {\n                                console.log(\"加载图片失败\");\n                            },\n                        });\n                    }\n                    this.layer.active = true;\n                } else {\n                    console.log(\"不存在\");\n                }\n            }\n        }, this);\n\n        var seq = cc.sequence(\n            first,\n            move,\n            finished,\n        );\n\n\n        if (this.state == \"close\") {\n            this.canvas.runAction(seq);\n        }\n    },\n\n    hide: function (data) {\n        var self = this;\n        var first = cc.callFunc(function () {\n            this.state = \"move\";\n        }, this);\n        var move = cc.moveTo(0.3, self.startP);\n        var finished = cc.callFunc(function () {\n            this.state = \"close\";\n\n            data.callback && data.callback()\n        }, this);\n\n        var seq = cc.sequence(\n            first,\n            move,\n            finished,\n        );\n\n        if (this.state == \"open\") {\n            this.canvas.runAction(seq);\n        }\n    },\n\n    //test\n    readBtn: function () {\n        if (CC_WECHATGAME) {\n            fileSystemManager.showFile();\n        } else {\n            var localData = JSON.parse(cc.sys.localStorage.getItem(KEY));\n            // console.log(localData);\n            if (localData != \"null\") {\n                var array = Object.keys(localData);\n                console.log(array);\n            } else {\n                console.log(\"空\");\n            }\n        }\n    },\n\n    clearLocsl: function () {\n        cc.sys.localStorage.setItem(KEY, JSON.stringify({}));\n    },\n\n    removeAllFile: function () {\n\n        if (CC_WECHATGAME) {\n            var loadString = cc.sys.localStorage.getItem(KEY);\n            var localData = JSON.parse(loadString);\n            var array = Object.keys(localData);\n            console.log(array);\n\n            array.forEach(element => {\n\n                fileSystemManager.removeFile({\n                    url: localData[element].logo,\n                    success: function () {\n                        console.log(\"删除成功\");\n                    },\n                });\n\n                fileSystemManager.removeFile({\n                    url: localData[element].qrcode,\n                    success: function () {\n                        console.log(\"删除成功\");\n                    },\n                });\n            });\n            cc.sys.localStorage.setItem(KEY, JSON.stringify({}));\n        } else {\n            cc.sys.localStorage.setItem(KEY, JSON.stringify({}));\n        }\n\n\n    },\n\n});\n"]}