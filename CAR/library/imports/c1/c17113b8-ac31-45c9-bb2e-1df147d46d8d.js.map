{"version":3,"sources":["../../../../assets/Scripts/assets/Scripts/gameplay.js"],"names":["define","require","Block","GameDataManager","MyLayoutManager","ShareManager","AdsManager","HintNode","cc","Class","properties","position","move","prev","index","statics","count","ctor","extends","Component","m_Gridiron","m_pPanda","Node","m_pBlocks","m_History","m_GridironSize","m_GameScaleY","m_GridSize","Size","curDate","m_MinSteps","m_Package","m_stage","m_HintBlockDestCoordinate","m_CurrentHintIndex","m_lastHints","m_HintMode","m_SolutionMoves","m_pHintBlock","default","type","bg_sprite","Sprite","menu_btn","Button","back_menu_btn","stage_btn","main_btn","sub_gameTitle","stageIdLab","Label","stageTitleLab","gold_btn","time","node","timeLab","gamepass","gameCenter","gameBtnNode","m_pHint","m_pVideoHint","m_pRetry","m_pGuideHintDest","m_pGuideHintPointer","audio","AudioSource","audioClick","audioMove","audioComplete","audioControl","m_kOffsetScale","m_DraggedMinX","m_DraggedMaxX","m_DraggedMinY","m_DraggedMaxY","gold_lab","onLoad","Date","find","getComponent","init","log","money","on","updatemoney","getInstance","getGoals","i","string","getLatestPackage","getGameCurLevelNum","getTextById","getGridironSize","visibleRect","getVisibleRect","visibleCenter","origin","size","kWH","width","height","kHW","scaleY","kOffsetHW","gameRectWidth","getHorizontalGridironPadding","gameRectHeight","GRIDIRON_WIDTH","setGridSize","rectX","x","getPosition","rectY","y","m_GameRect","Rect","curLevelData","getStageData","minmove","m_BlockData","length","coordinate","state","addBlock","kOrientation_Horizontal","kOrientation_Vertical","orientation","panda","id","urlPath","blockNode","blockSp","addComponent","gameLayout","addChild","pBlock","data","setId","gPosition","Vec2","isOccupiedBlock","push","setOnBlockListener","setPosition","setGPosition","updateGridiron","isOccupiedPos","isOccupiedGpos","gpos","getOrientation","t","getLength","getGPosition","j","parseInt","DEBUG_MODE","DEBUG_SHOW_MAP","console","res","Array","temp","pos","Math","min","max","onDragged","event","minX","maxX","getAbsolutePosition","minY","maxY","newGpos","DEBUG_SHOW_POS","touches","getTouches","touchLoc","getLocation","getId","onMove","touch","newPosition","movePosition","getTouchBeganPosition","getStartLocation","getContentSize","s_CurrentTouchedBlock","m_State","kBlockState_Grabbed","kBlockState_Ungrabbed","m_OnBlockListener","onDrop","setBlockPosition","diff","getTouchBeganGPosition","unshift","steps","showHint","updateHint","playMove","checkComplete","playComplete","onGameComplete","getLastGPosition","stopActionByTag","kMoveActionTag","stopAllActions","active","savegold","emit","getGameState","m_Mode","GameMode_Relax","winStarNum","lastStars","saveGameState","showCompleteView","addGoals","goals","dialogGamePass","showDialog","start","getIsFistPlay","getGamePlaySceneReload","setGamePlaySceneReload","director","loadScene","scheduleOnce","startFindSolution","queue","record","Set","gridironW","gridironH","current","solutionIndex","base","EXIT_Flag","newNode","add","gridiron","lastMoveBlockId","p","offset","maxRightStep","step","b1","b2","has","tempNode","encodeMove","kDirection_Right","kDirection_Left","kDirection_Up","kDirection_Down","tempArr","startShowHints","direction","clear","dest","spriteFrame","action","blink","setTag","kBlinkActionTag","runAction","repeatForever","setScale","designSize","self","loader","loadRes","SpriteFrame","err","getHintDestFrameName","gpDest","pointerRotation","offsetResolutionSize","view","getVisibleSize","hideAction","hide","positionDest","centerOffset","getScaleX","getScaleY","Scale","getGridSize","showAction","show","actionBlick","guideHintPointerPos","clone","setRotation","opacity","action1","moveTo","action2","fadeOut","action3","fadeIn","action4","sequence","getHintCallback","playClick","getCurrentTouchedBlock","getgold","gold_btnClick","gold_btnCallback","videohint_btnClick","videohint_btnCallback","add_touch_listeners","canvas","EventType","TOUCH_START","TOUCH_MOVE","TOUCH_END","update","dt","secondTime","getPassTime","minuteTime","hourTime","getNowTime","testDate","getTime","nowDate","passTime","passtime","menu_btnClick","back_menu_btnClick","stage_btnClick","main_btnClick","retryCallback"],"mappings":"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","file":"gameplay.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["var define = require(\"define\");\nvar Block = require(\"BlockJS\");\nvar GameDataManager = require(\"GameDataManagerJS\");\nvar MyLayoutManager = require(\"MyLayoutManagerJS\");\nvar ShareManager = require(\"ShareManagerJS\");\nvar AdsManager = require(\"AdsManagerJS\");\n\nvar HintNode = cc.Class({\n    properties: {\n        position: 0,\n        move: 0,\n        prev: 0,\n        index: 0,\n    },\n    statics: {\n        count: 0,\n    },\n    ctor(position, move, prev) {\n        this.position = position;\n        this.move = move;\n        this.prev = prev;\n        this.index = HintNode.count++;\n    },\n\n});\n\n\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        m_Gridiron: [0],//car数组\n        m_pPanda: cc.Node,//目标车\n        m_pBlocks: [cc.Node],\n        m_History: [0],\n\n        m_GridironSize: 0,\n        m_GameScaleY: 1,\n        m_GridSize: cc.Size,\n\n        curDate: 0,\n        m_MinSteps: 1,\n        m_Package: 0,\n        m_stage: 0,\n        m_HintBlockDestCoordinate: 0,\n        m_CurrentHintIndex: -1,\n        m_lastHints: 0,\n\n        m_HintMode: false,\n        m_SolutionMoves: [0],\n\n        m_pHintBlock: {\n            default: null,\n            type: cc.Block\n        },\n        bg_sprite: cc.Sprite,//一层背景图\n        menu_btn: cc.Button,\n        back_menu_btn: cc.Button,\n        stage_btn: cc.Button,\n        main_btn: cc.Button,\n        sub_gameTitle: cc.Sprite,//上面两个挂载节点\n        stageIdLab: cc.Label,  //关卡id\n        stageTitleLab: cc.Label,//第   关\n        gold_btn: cc.Button,\n\n        time: cc.node,\n        timeLab: cc.Label,\n\n        gamepass: cc.Node,\n        gameCenter: cc.Node,\n\n        gameBtnNode: cc.Node,//底部btn\n        m_pHint: cc.Button,\n        m_pVideoHint: cc.Button,\n        m_pRetry: cc.Button,\n        // m_share_btn: cc.Button,\n\n        m_pGuideHintDest: cc.Sprite,\n        m_pGuideHintPointer: cc.Sprite,\n\n        audio: {\n            type: cc.AudioSource,\n            default: null\n        },\n        audioClick: {\n            type: cc.AudioSource,\n            default: null\n        },\n        audioMove: {\n            type: cc.AudioSource,\n            default: null\n        },\n        audioComplete: {\n            type: cc.AudioSource,\n            default: null\n        },\n        audioControl:\n        {\n            default: null,\n        },\n        // gameLayout: {\n\n        //     default: null,\n        // },\n        // 缩放系数\n        m_kOffsetScale: 1,\n\n        m_DraggedMinX: 0.0,\n        m_DraggedMaxX: 0.0,\n        m_DraggedMinY: 0.0,\n        m_DraggedMaxY: 0.0,\n\n        gold_lab: cc.Label,\n\n\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        this.curDate = new Date();\n        // this.gamepass.active = false;\n        this.audioControl = cc.find('AudioControlNode').getComponent('AudioSourceControl');\n        this.init();\n        cc.log(\"+++++\", define.money)\n        this.node.on(\"updatemoney\", () => {\n            this.updatemoney();\n        });\n        cc.log(\"*********\",GameDataManager.getInstance().getGoals())\n\n    },\n    init() {\n        //  cc.director.loadScene(\"game\");\n\n        cc.log(\"===========GAME INIT============\")\n        for (var i = 0; i < 8; ++i) {\n            this.m_Gridiron[i] = 0;\n        }\n        // this.gold = GameDataManager.getInstance().getgold();\n        this.gold_lab.string = define.money;\n        this.m_Package = GameDataManager.getInstance().getLatestPackage();//1\n        this.m_stage = GameDataManager.getInstance().getGameCurLevelNum();//0\n        this.stageIdLab.string = GameDataManager.getInstance().getTextById(12) + (this.m_stage + 1);//关卡1\n        this.m_GridironSize = MyLayoutManager.getInstance().getGridironSize();// width 6   height 6\n\n        // this.stageTitleLab.string = GameDataManager.getInstance().getTextById(12);//' LEVEL ';// GameDataManager.getInstance().getTextById(12);\n\n        var visibleRect = MyLayoutManager.getInstance().getVisibleRect();//{x: 0, y: 0, width: 750, height: 1334}\n        var visibleCenter = visibleRect.origin + visibleRect.size / 2;//(0.00, 0.00)NaN\n        var kWH = visibleRect.size.width / visibleRect.size.height;//0.5622188905547226\n        var kHW = visibleRect.size.height / visibleRect.size.width;//1.778666666666666\n        var scaleY = visibleRect.size.height / 1334;//1\n        //==========\n        var kOffsetHW = kHW / (1334 / 750.0)//1\n        //MyLayoutManager.getInstance().getHorizontalGridironPadding()是8\n        var gameRectWidth = visibleRect.size.width - MyLayoutManager.getInstance().getHorizontalGridironPadding() * 2;// visibleRect.size.width - MyLayoutManager.getInstance().getHorizontalGridironPadding() * 2;\n        var gameRectHeight = gameRectWidth;//734\n        {\n            // var gameRectHeight = visibleRect.size.height - MyLayoutManager.getInstance().getHorizontalGridironPadding() * 10 * 2;\n            // var gameRectWidth = this.gameCenter.width - MyLayoutManager.getInstance().getHorizontalGridironPadding() * 2;// visibleRect.size.width - MyLayoutManager.getInstance().getHorizontalGridironPadding() * 2;\n            // var gameRectHeight = this.gameCenter.height - MyLayoutManager.getInstance().getHorizontalGridironPadding() * 10 * 2;\n            //gameRectWidth:24,gameRectHeight:-124\n            //高宽比 较小的\n            // if (kOffsetHW < 0.75) {\n            //     //pad\n            //     var kOffsetRedress = 1.3\n            //     this.m_kOffsetScale = kOffsetHW * kOffsetRedress\n            //     gameRectWidth = gameRectWidth * (this.m_kOffsetScale);\n            //     gameRectHeight *= (this.m_kOffsetScale);\n            //     this.gameCenter.node.setScale(this.m_kOffsetScale);\n            // } else\n            //     if (kOffsetHW < 0.9) {\n            //         //pad\n            //         var kOffsetRedress = 1.10\n            //         this.m_kOffsetScale = kOffsetHW * kOffsetRedress\n            //         gameRectWidth = gameRectWidth * (this.m_kOffsetScale);\n            //         gameRectHeight *= (this.m_kOffsetScale);\n            //         this.gameCenter.setScale(this.m_kOffsetScale);\n            //     } else if (kOffsetHW < 0.95) {\n            //         //pad\n            //         var kOffsetRedress = 1.04\n            //         this.m_kOffsetScale = kOffsetHW * kOffsetRedress\n            //         gameRectWidth = gameRectWidth * (this.m_kOffsetScale);\n            //         gameRectHeight *= (this.m_kOffsetScale);\n            //         this.gameCenter.node.setScale(this.m_kOffsetScale);\n            //     }\n\n            // console.log(\" gameRect  \" + gameRectWidth + \" \" + gameRectHeight);\n        }\n        this.m_GridironSize.width = this.m_GridironSize.height = define.GRIDIRON_WIDTH;\n        this.m_GridSize.width = gameRectWidth / this.m_GridironSize.width;\n        this.m_GridSize.height = gameRectHeight / this.m_GridironSize.height;\n        MyLayoutManager.getInstance().setGridSize(this.m_GridSize);//设置一个格子大小\n\n        // var gameCenterBox = this.gameCenter.getBoundingBox();//返回父节坐标系下的轴向对齐的包围盒//0000\n        var rectX = visibleRect.origin.x + visibleRect.size.width * 0.5 + this.gameCenter.getPosition().x - gameRectWidth * 0.5\n        var rectY = visibleRect.origin.y + visibleRect.size.height * 0.5 + this.gameCenter.getPosition().y - gameRectHeight * 0.5 - 10\n        this.m_GameRect = new cc.Rect(rectX, rectY, gameRectWidth, gameRectHeight);\n        {\n            //             var kMoveHight = (kWH - 750 / 1334)\n            //             console.log(\"  k= \" + 750 / 1334 + \" kWH= \" + kWH);\n            //             if (kMoveHight > 0) {\n            //                 //<1.778的屏幕 eg  pad\n            //                 var offsetk = 700;\n            //                 var title_pos = this.sub_gameTitle.node.getPosition();\n            //                 title_pos.y -= kMoveHight * offsetk;\n\n            //                 //移动到top位置\n            //                 //title_pos.y = (visibleRect.size.height - this.sub_gameTitle.node.getContentSize().height * this.m_kOffsetScale) / 2\n\n            //                 //移动到中心区域上方\n            //                 var topOffset = this.sub_gameTitle.node.height * this.m_kOffsetScale * 0.5\n            //                 title_pos.y = this.gameCenter.node.getPosition().y + (gameCenterBox.height) / 2 + topOffset;\n            //                 if (title_pos.y > visibleRect.size.height / 2 + topOffset * 0.3) {\n            //                     console.log(\" sub_gameTitle up 超过top区域  固定在top区域 \");\n            //                     title_pos.y = (visibleRect.size.height - topOffset * 0.2) / 2\n            //                 }\n\n            //                 this.sub_gameTitle.node.setPosition(title_pos);\n\n            //                 var bg_title = this.sub_gameTitle.node.getChildByName(\"bgSprite\");\n            //                 bg_title.setScale(visibleRect.size.width / 750, kOffsetHW);\n            //                 console.log(\" pad  this  k  \" + kOffsetHW);\n\n            //                 //底部按钮 挨着中间区域底部\n            //                 var funBtn_pos = this.gameBtnNode.getPosition();\n            //                 funBtn_pos.y = this.gameCenter.node.getPosition().y - (this.gameBtnNode.height + gameCenterBox.height) / 2\n\n            //                 if (funBtn_pos.y < -visibleRect.size.height / 2) {\n            //                     funBtn_pos.y = -visibleRect.size.height / 2 + this.gameBtnNode.height * (1 / 3)\n            //                 }\n            //                 this.gameBtnNode.setPosition(funBtn_pos);\n\n            //                 console.log(\" sub_gameTitle down \");\n            //             } else {\n            //                 var offsetk = 1000;\n            //                 var title_pos = this.sub_gameTitle.node.getPosition();\n            //                 title_pos.y += (-kMoveHight) * offsetk;\n\n            //                 title_pos.y = (visibleRect.size.height - this.sub_gameTitle.node.getContentSize().height * this.m_kOffsetScale) / 2\n            //                 this.sub_gameTitle.node.setPosition(title_pos);\n\n            //                 console.log(\" sub_gameTitle up \");\n            //             }\n\n            //             console.log(\" m_CurrentHintIndex \" + this.m_CurrentHintIndex);\n        }\n        var curLevelData = GameDataManager.getInstance().getStageData(this.m_Package, this.m_stage);\n        this.m_MinSteps = curLevelData.minmove;\n        for (var i = 0; i < curLevelData.m_BlockData.length; i++) {\n            var coordinate = curLevelData.m_BlockData[i].coordinate;\n            var state = curLevelData.m_BlockData[i].state;\n            this.addBlock((coordinate & 0xF0) >> 4, coordinate & 0x0F, (state & 0x20) ? define.kOrientation_Horizontal : define.kOrientation_Vertical, state & 0x0F, (state & 0x10) != 0);\n        }\n    },\n    addBlock(x, y, orientation, length, panda) {\n        var id = 0;\n        if (orientation == define.kOrientation_Horizontal) {//方向是水平的\n            y = this.m_GridironSize.height - 1 - y;\n        }\n        else if (orientation == define.kOrientation_Vertical) {\n            y = this.m_GridironSize.height - length - y;\n        }\n        if (id <= 0) {\n            id = this.m_pBlocks.length + 1;\n        }\n        var urlPath = (\"resources/playGamePic/car0.png\");\n        var blockNode = new cc.Node('Sprite');\n        var blockSp = blockNode.addComponent(cc.Sprite);\n        var gameLayout = cc.find(\"Canvas/gameplay/gameCenterNode\");\n        gameLayout.addChild(blockNode);\n\n        var pBlock = blockNode.addComponent('BlockJS');\n        var data = { orientation: 0, length: 0, panda: true };\n        data.orientation = orientation;\n        data.length = length;\n        data.panda = panda;\n\n        blockNode.getComponent('BlockJS').init(data);//设置方向长度panda\n        blockNode.getComponent('BlockJS').setId(id);//传id\n        var gPosition = new cc.Vec2(x, y);\n        if (!this.isOccupiedBlock(pBlock, gPosition)) {\n            this.m_pBlocks.push(blockNode);\n            blockNode.getComponent('BlockJS').setOnBlockListener(this);\n            blockNode.getComponent('BlockJS').setPosition(this.getPosition(gPosition));\n            blockNode.getComponent('BlockJS').setGPosition(gPosition);\n            this.updateGridiron();\n            if (panda) {\n                this.m_pPanda = blockNode.getComponent(\"BlockJS\");\n            }\n            return true;\n        }\n        return false;\n    },\n    isOccupiedPos: function (x, y) {\n        if (x >= 0 && y >= 0 && x < this.m_GridironSize.width && y < this.m_GridironSize.height) {\n            return ((this.m_Gridiron[y] & (0x1 << x)) != 0);\n        }\n        else {\n            return true;\n        }\n    },\n    isOccupiedGpos: function (gpos) {\n        return this.isOccupiedPos(gpos.x, gpos.y);\n    },\n    isOccupiedBlock: function (pBlock, gpos) {\n        var orientation = pBlock.getOrientation();\n        if (orientation == define.kOrientation_Horizontal) {\n            var t = new cc.Vec2(gpos.x, gpos.y);\n            for (var i = 0; i < pBlock.getLength(); i++ , t.x++) {\n                if (this.isOccupiedGpos(t)) {\n                    return true;\n                }\n            }\n        } else if (orientation == define.kOrientation_Vertical) {\n            var t = new cc.Vec2(gpos.x, gpos.y);\n            for (var i = 0; i < pBlock.getLength(); i++ , t.y++) {\n                if (this.isOccupiedGpos(t)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    },\n    updateGridiron: function () {\n        for (var i = 0; i < this.m_Gridiron.length; i++) {\n            this.m_Gridiron[i] = 0;\n        }\n\n        for (var i = 0; i < this.m_pBlocks.length; i++) {\n            var blockNode = this.m_pBlocks[i];\n            var pBlock = blockNode.getComponent('BlockJS')\n\n            var orientation = pBlock.getOrientation();\n            var gPosition = pBlock.getGPosition();\n\n            if (gPosition.x >= 0 && gPosition.y >= 0) {\n                if (orientation == define.kOrientation_Horizontal) {\n                    for (var j = 0; j < pBlock.getLength(); j++) {\n                        this.m_Gridiron[parseInt(gPosition.y)] |= (0x1 << parseInt(gPosition.x + j))\n                    }\n                }\n                else if (orientation == define.kOrientation_Vertical) {\n                    for (var j = 0; j < pBlock.getLength(); j++) {\n                        this.m_Gridiron[parseInt(gPosition.y + j)] |= (0x1 << parseInt(gPosition.x));\n                    }\n                }\n            }\n        }\n\n        if (define.DEBUG_MODE && define.DEBUG_SHOW_MAP) {\n            console.log(\"*************begin to print*************\\n\");\n            var res = new Array();\n            for (var i = this.m_GridironSize.height - 1; i >= 0; i--) {\n                for (var j = 0; j < this.m_GridironSize.width; j++) {\n                    res[j] = (this.m_Gridiron[i] & (0x1 << j)) ? 'x' : '.';\n                }\n                res[parseInt(this.m_GridironSize.width)] = 0;\n\n                var temp = new Array();\n                for (var j = 0; j < this.m_GridironSize.width; j++) {\n                    temp += res[j];\n                }\n                //    console.log(\" \"+res);\n                console.log(i + \" \" + temp);\n            }\n            console.log(\"*************end print*************\\n\");\n        }\n    },\n    getPosition: function (gPosition) {\n        var pos = new cc.Vec2(this.m_GameRect.origin.x + gPosition.x * this.m_GridSize.width, this.m_GameRect.origin.y + gPosition.y * this.m_GridSize.height);\n        return pos;\n    },\n\n    getGPosition: function (position) {\n        var x = (position.x - this.m_GameRect.origin.x) / this.m_GridSize.width;//在第x个格子\n        x = parseInt(x + (x > 0 ? 0.5 : -0.5));\n        x = Math.min(Math.max(0, x), this.m_GridironSize.width - 1);\n\n        var y = (position.y - this.m_GameRect.origin.y) / this.m_GridSize.height;\n        y = parseInt(y + (y > 0 ? 0.5 : -0.5));\n        y = Math.min(Math.max(0, y), this.m_GridironSize.height - 1);\n\n        return new cc.Vec2(x, y);\n    },\n    onDragged: function (pBlock, event) {\n\n        if (this.m_pHintBlock && this.m_pHintBlock != pBlock) {\n            return false;\n        }\n\n        var gPosition = pBlock.getGPosition();\n        var orientation = pBlock.getOrientation();\n        if (orientation == define.kOrientation_Horizontal) {\n            var minX = gPosition.x;\n            var maxX = gPosition.x;\n\n            while (!this.isOccupiedPos(minX - 1, gPosition.y)) {\n                minX--;\n            }\n            while (!this.isOccupiedPos(maxX + pBlock.getLength(), gPosition.y)) {\n                maxX++;\n            }\n\n            this.m_DraggedMinX = this.m_GameRect.origin.x + minX * this.m_GridSize.width;\n            this.m_DraggedMaxX = this.m_GameRect.origin.x + maxX * this.m_GridSize.width;\n            this.m_DraggedMinY = this.m_DraggedMaxY = pBlock.getAbsolutePosition().y;\n        } else if (orientation == define.kOrientation_Vertical) {\n            var minY = gPosition.y;\n            var maxY = gPosition.y;\n\n            while (!this.isOccupiedPos(gPosition.x, minY - 1)) {\n                minY--;\n            }\n            while (!this.isOccupiedPos(gPosition.x, maxY + pBlock.getLength())) {\n                maxY++;\n            }\n\n            this.m_DraggedMinX = this.m_DraggedMaxX = pBlock.getAbsolutePosition().x;\n            this.m_DraggedMinY = this.m_GameRect.origin.y + minY * this.m_GridSize.height;\n            this.m_DraggedMaxY = this.m_GameRect.origin.y + maxY * this.m_GridSize.height;\n        }\n\n        var newGpos = new cc.Vec2(-1, -1);\n        pBlock.setGPosition(newGpos);\n\n        this.updateGridiron();\n\n        if (define.DEBUG_MODE && define.DEBUG_SHOW_POS) {\n            var touches = event.getTouches();\n            var touchLoc = touches[0].getLocation();\n            console.log(\"  car \" + pBlock.getId() + \" start\" + \"=\" + touchLoc.x + \",\" + touchLoc.y);\n            console.log(\" game onDragged =\");\n        }\n        return true;\n    },\n\n    onMove: function (pBlock, event) {\n        var touches = event.getTouches();\n        var touch = touches[0];\n        var touchLoc = touches[0].getLocation();\n        //最后终点位置\n        var newPosition = new cc.Vec2;\n        //移动\n        var movePosition = new cc.Vec2;\n        movePosition.x = pBlock.getTouchBeganPosition().x + touch.getLocation().x - touch.getStartLocation().x;\n        movePosition.y = pBlock.getTouchBeganPosition().y + touch.getLocation().y - touch.getStartLocation().y;\n\n        newPosition = new cc.Vec2(Math.min(Math.max(this.m_DraggedMinX, movePosition.x), this.m_DraggedMaxX), Math.min(Math.max(this.m_DraggedMinY, movePosition.y), this.m_DraggedMaxY))\n        //屏幕绝对坐标\n        pBlock.setPosition(newPosition);\n\n        if (define.DEBUG_MODE && define.DEBUG_SHOW_POS) {\n            console.log(\" game onMove =\");\n\n            console.log(\"  car \" + pBlock.getId() + \" move\" + \"=\" + touchLoc.x + \",\" + touchLoc.y);\n        }\n\n        if (((touchLoc.x > pBlock.getAbsolutePosition().x) && (touchLoc.x < pBlock.getAbsolutePosition().x + pBlock.getContentSize().width * 1.3)) &&\n            ((touchLoc.y > pBlock.getAbsolutePosition().y) && (touchLoc.y < pBlock.getAbsolutePosition().y + pBlock.getContentSize().height * 1.3))) {\n        } else {\n            console.log(\"  超出矩形范围  \" + touchLoc.x + \" ，\" + touchLoc.y);\n            if (Block.s_CurrentTouchedBlock != pBlock)\n                return;\n            if (pBlock.m_State == define.kBlockState_Grabbed) {\n                pBlock.m_State = define.kBlockState_Ungrabbed;\n                if (pBlock.m_OnBlockListener) {\n                    this.onDrop(pBlock, event);\n                }\n            }\n            Block.s_CurrentTouchedBlock = null;\n        }\n    },\n\n    onDrop: function (pBlock, event) {\n\n        this.setBlockPosition(pBlock, pBlock.getAbsolutePosition());\n        var diff = new cc.Vec2;\n        diff.x = pBlock.getGPosition().x - pBlock.getTouchBeganGPosition().x;\n        diff.y = pBlock.getGPosition().y - pBlock.getTouchBeganGPosition().y;\n\n        if (diff.x || diff.y) {\n            var temp = (pBlock.getId() << 24) | ((pBlock.getOrientation() == define.kOrientation_Horizontal ? parseInt(diff.x + 10) : parseInt(diff.y + 10)) << 16) | (this.m_CurrentHintIndex + 1);\n            this.m_History.unshift(temp);\n\n            var steps = this.m_History.length;\n\n            if (define.DEBUG_MODE) {\n                console.log(\" getId=  \" + pBlock.getId() + \" x= \" + diff.x + \" y= \" + diff.y + \" m_CurrentHintIndex=\" + this.m_CurrentHintIndex);\n                console.log(\" temp=  \" + temp);\n            }\n            // m_pUndo.setEnabled(true);\n            // m_pRetry.setEnabled(true);\n\n            if (this.m_pHintBlock && this.m_pHintBlock == pBlock) {\n                var coordinate = this.m_pHintBlock.getOrientation() == define.kOrientation_Horizontal ? this.m_pHintBlock.getGPosition().x : this.m_pHintBlock.getGPosition().y;\n                if (coordinate == this.m_HintBlockDestCoordinate) {\n                    this.showHint(this.m_CurrentHintIndex + 1);\n                }\n                else {\n                    this.updateHint();\n                }\n            }\n        }\n\n        this.playMove();\n\n        // AudioManager::getInstance()->playEffect(MOVE_EFFECT_FILE);\n        if (this.m_pPanda && pBlock == this.m_pPanda) {\n            console.log(\" checkComplete  \");\n            if (this.checkComplete()) {\n                console.log(\" on Complete  \");\n                this.playComplete();\n                this.onGameComplete();\n            }\n        }\n\n        if (define.DEBUG_MODE && define.DEBUG_SHOW_POS) {\n            console.log(\" game onDrop =\");\n            var touches = event.getTouches();\n            var touchLoc = touches[0].getLocation();\n            console.log(\"  car \" + pBlock.getId() + \" end\" + \"=\" + touchLoc.x + \",\" + touchLoc.y);\n        }\n    },\n    setBlockPosition: function (pBlock, position) {\n        if (define.DEBUG_MODE && define.DEBUG_SHOW_POS) {\n            console.log(\"  setBlockPosition= \" + parseInt(position.x) + \",\" + parseInt(position.y));\n        }\n        var gPosition = this.getGPosition(position);\n        if (!this.isOccupiedBlock(pBlock, gPosition)) {\n            pBlock.setPosition(this.getPosition(gPosition));\n            pBlock.setGPosition(gPosition);\n            this.updateGridiron();\n        } else {\n            pBlock.setPosition(this.getPosition(pBlock.getLastGPosition()));\n        }\n    },\n    //目标车位置判断过关\n    checkComplete: function () {\n        if (this.m_pPanda && this.m_pPanda.getGPosition().x + this.m_pPanda.getLength() == this.m_GridironSize.width) {\n            return true;\n        }\n        return false;\n    },\n    onGameComplete: function () {\n        // 如果有提示，则删除提示\n        if (this.m_HintMode) {\n            this.m_pGuideHintPointer.node.stopActionByTag(define.kMoveActionTag);\n            this.m_pGuideHintDest.node.stopAllActions();\n            this.m_pGuideHintDest.node.active = false;\n            this.m_pGuideHintPointer.node.active = false;\n            this.m_HintMode = false;\n        }\n        define.money+=5;\n        GameDataManager.getInstance().savegold(define.money);\n        this.node.emit(\"updatemoney\");\n        var state = GameDataManager.getInstance().getGameState(this.m_Package, this.m_stage);\n        var steps = this.m_History.length;\n        var m_Mode = define.GameMode_Relax;\n        if (m_Mode == define.GameMode_Relax) {\n            // stars\n            var winStarNum = steps <= (this.m_MinSteps + 3) ? 3 : (steps <= (this.m_MinSteps + 10) ? 2 : 1);\n            var lastStars = state;\n            if (define.DEBUG_MODE) {\n                console.log(\"winStarNum = \" + winStarNum);\n            }\n\n            if (winStarNum > lastStars) {\n                //更新星星数目\n                GameDataManager.getInstance().saveGameState(this.m_Package, this.m_stage, winStarNum);\n                // AudioManager::getInstance()->playEffect(ADD_STAR);\n            }\n        }\n        // AudioManager::getInstance()->playEffect(COMPLETE_EFFECT_FILE);\n        this.showCompleteView(winStarNum);\n\n        GameDataManager.getInstance().addGoals()\n\n        var goals = GameDataManager.getInstance().getGoals()\n        if (define.DEBUG_MODE) {\n            console.log(\"play counts = \" + goals);\n        }\n    },\n    showCompleteView: function (winStarNum) {\n        this.playComplete();\n        var dialogGamePass = cc.find(\"Canvas/DialogGamePass\").getComponent('DialogGamePassJS');\n        dialogGamePass.showDialog(winStarNum)\n\n        console.log(\"popGamePassDialog \");\n    },\n\n\n    // 第一次玩  启动提示\n    start() {\n\n        if (GameDataManager.getInstance().getIsFistPlay() == true) {\n            cc.log(\"第一次玩\")\n            if (GameDataManager.getInstance().getGamePlaySceneReload() == false) {\n                GameDataManager.getInstance().setGamePlaySceneReload(true);\n                console.log(\"  Reload game\");\n                cc.director.loadScene(\"game\");\n            } else {\n                cc.log(\"第一次玩,开始提示\")\n                this.scheduleOnce(function () {\n                    this.startFindSolution();\n                }, 0.5);\n            }\n        }\n    },\n\n    startFindSolution() {\n        console.log(\"  findSolutionProc  \");\n\n        var queue = new Array();\n        var record = new Set();\n        this.m_SolutionMoves = new Array();\n\n        var gridironW = this.m_GridironSize.width\n        var gridironH = this.m_GridironSize.height;\n        var current = 0;\n        var solutionIndex = 0;\n        var size = this.m_pBlocks.length;\n        var position = 0;\n        var base = 1;\n\n        var EXIT_Flag = false;\n\n        for (var index = 0; index < size; index++ , base *= gridironW) {\n            var blockNode = this.m_pBlocks[index];\n            var pBlock = blockNode.getComponent('BlockJS')\n\n            position += (pBlock.getOrientation() == define.kOrientation_Horizontal ? parseInt(pBlock.getGPosition().x) : parseInt(pBlock.getGPosition().y)) * base;\n        }\n\n        var newNode = new HintNode(position, 0, null)\n        queue.push(newNode);\n        record.add(position);\n\n        var gridiron = new Array();\n\n        while (current < queue.length) {\n            var node = queue[current++];\n            var lastMoveBlockId = node.move > 0 ? node.move / 1000 : -1;\n\n            for (var i = 0; i < gridironW * gridironH; i++) {\n                gridiron[i] = 0;\n            }\n\n            // resolve position information from long int position\n            base = 1;\n\n            for (var index = 0; index < size; index++ , base *= gridironW) {\n                var blockNode = this.m_pBlocks[index];\n                var pBlock = blockNode.getComponent('BlockJS')\n\n                var p = parseInt(node.position % (base * gridironW) / base);\n\n                if (pBlock.getOrientation() == define.kOrientation_Horizontal) {\n                    var offset = pBlock.getGPosition().y * gridironW;\n                    for (var j = p; j <= p + pBlock.getLength() - 1; j++) {\n                        //  CC_ASSERT(offset + j >= 0);\n                        gridiron[offset + j] = pBlock.getId();\n                    }\n                } else {\n                    for (var j = p; j <= p + pBlock.getLength() - 1; j++) {\n                        //CC_ASSERT((int )pBlock.getGPosition().x + j * gridironH >= 0);\n                        gridiron[parseInt(pBlock.getGPosition().x + j * gridironW)] = pBlock.getId();\n                    }\n                }\n            }\n\n            base = 1;\n\n            for (var index = 0; index < size; index++ , base *= gridironW) {\n                var blockNode = this.m_pBlocks[index];\n                var pBlock = blockNode.getComponent('BlockJS')\n\n                if (pBlock.getId() == lastMoveBlockId) {\n                    continue;\n                }\n\n                var x, y;\n                if (pBlock.getOrientation() == define.kOrientation_Horizontal) {\n                    x = parseInt(node.position % (base * gridironW) / base);\n                    y = parseInt(pBlock.getGPosition().y);\n                }\n                else {\n                    x = parseInt(pBlock.getGPosition().x);\n                    y = parseInt(node.position % (base * gridironW) / base);\n                }\n\n                if (pBlock.getOrientation() == define.kOrientation_Horizontal) {\n                    var offset = y * gridironW + x;\n                    // Move Right\n                    var maxRightStep = 0;\n                    for (var step = 1; x + step + pBlock.getLength() - 1 < gridironW && gridiron[offset + step + pBlock.getLength() - 1] == 0; step++) {\n\n                        var b1 = x + step + pBlock.getLength() - 1 < gridironW;\n                        var b2 = (gridiron[offset + step + pBlock.getLength() - 1] == 0);\n                        //CC_ASSERT(offset + step + pBlock.getLength() - 1 >= 0);\n                        var newPosition = node.position + base * step;\n                        if (record.has(newPosition) == false) {\n                            var tempNode = new HintNode(newPosition, this.encodeMove(pBlock.getId(), define.kDirection_Right, x + step), node);\n                            queue.push(tempNode);\n                            record.add(newPosition);\n\n                            maxRightStep = step;\n                        }\n                    }\n                    if (this.m_pPanda && pBlock == this.m_pPanda && x + maxRightStep + pBlock.getLength() == gridironW) {\n                        solutionIndex = queue.length - 1;\n                        // goto EXIT;\n                        EXIT_Flag = true;\n                        break;\n                    }\n\n                    // Move Left\n                    for (var step = -1; x + step >= 0 && gridiron[offset + step] == 0; step--) {\n                        //    CC_ASSERT(offset + step >= 0);\n                        var newPosition = node.position + base * step;\n                        if (record.has(newPosition) == false) {\n                            var tempNode = new HintNode(newPosition, this.encodeMove(pBlock.getId(), define.kDirection_Left, x + step), node);\n                            queue.push(tempNode);\n                            record.add(newPosition);\n                        }\n                    }\n                }\n\n                else {\n                    var offset = y * gridironW + x;\n                    // Move Up\n                    for (var step = 1; y + step + pBlock.getLength() - 1 < gridironH && gridiron[offset + (step + pBlock.getLength() - 1) * gridironW] == 0; step++) {\n                        //    CC_ASSERT(offset + (step + pBlock.getLength() - 1) * gridironW >= 0);\n                        var newPosition = node.position + base * step;\n                        if (record.has(newPosition) == false) {\n                            var tempNode = new HintNode(newPosition, this.encodeMove(pBlock.getId(), define.kDirection_Up, y + step), node);\n                            queue.push(tempNode);\n                            record.add(newPosition);\n                        }\n                    }\n\n                    // Move Down\n                    for (var step = -1; y + step >= 0 && gridiron[offset + step * gridironW] == 0; step--) {\n                        //    CC_ASSERT(offset + step * gridironW >= 0);\n                        var newPosition = node.position + base * step;\n                        if (record.has(newPosition) == false) {\n                            var tempNode = new HintNode(newPosition, this.encodeMove(pBlock.getId(), define.kDirection_Down, y + step), node)\n                            queue.push(tempNode);\n                            record.add(newPosition);\n                        }\n                    }\n                }\n            }\n\n            if (EXIT_Flag == true) {\n                break;\n            }\n        }\n        // EXIT:\n        var tempArr = new Array();\n        if (solutionIndex >= 0) {\n            var node = queue[solutionIndex];\n            while (node) {\n                if (node.move != 0) {\n                    tempArr.push(node.move)\n                    this.m_SolutionMoves.unshift(node.move);\n                }\n                node = node.prev;\n            }\n\n            tempArr.length;\n            for (var i = 0; i < this.m_SolutionMoves.length; ++i) {\n                console.log(\" \" + this.m_SolutionMoves[i]);\n            }\n\n            if (this.m_SolutionMoves.length > 0) {\n\n                this.scheduleOnce(function () {\n                    this.startShowHints();\n                }, 0);\n            }\n        }\n\n    },\n    encodeMove: function (id, direction, step) {\n        return id * 1000 + direction * 100 + step;\n    },\n\n    updatemoney() {\n        this.gold_lab.string = define.money;\n    },\n    startShowHints: function (index) {\n        cc.log(\"startShowHints\")\n        this.showHint(0);\n        // m_pHint->setEnabled(true);\n    },\n\n    showHint: function (index) {\n        cc.log(\"showHint\")\n        if (index < 0) {\n            this.m_HintMode = false;\n            if (this.m_pGuideHintDest) {\n                this.m_pGuideHintDest.node.active = false;\n                this.m_pGuideHintPointer = null;\n                //     removeChild(m_pGuideHintDest);\n            }\n            if (this.m_pGuideHintPointer) {\n                //     removeChild(m_pGuideHintPointer);\n                this.m_pGuideHintPointer.node.active = false;\n                this.m_pGuideHintPointer = null;\n            }\n            this.m_SolutionMoves.clear();\n            this.m_HintBlockDestCoordinate = 0;\n            this.m_CurrentHintIndex = index;\n\n            return;\n        }\n        this.m_HintMode = true;\n\n        // var iter = this.m_SolutionMoves[0];\n\n        if (index < parseInt(this.m_SolutionMoves.length)) {\n            var move = this.m_SolutionMoves[index];\n            var id = parseInt(move / 1000);\n            var dest = parseInt(move % 100);\n\n            for (var i = 0; i < this.m_pBlocks.length; i++) {\n                var blockNode = this.m_pBlocks[i];\n                var pBlock = blockNode.getComponent('BlockJS')\n\n                if (pBlock.getId() == id) {\n                    // if (this.m_pHintBlock)\n                    // {\n                    //     this.m_pHintBlock.clearHint();\n                    // }\n                    this.m_pHintBlock = pBlock;\n\n                    this.m_HintBlockDestCoordinate = dest;\n                    this.m_CurrentHintIndex = index;\n\n                    this.m_pGuideHintPointer.node.active = true;\n                    this.m_pGuideHintDest.node.active = true;\n                    if (this.m_pGuideHintPointer.spriteFrame == null) {\n                        var action = new cc.blink(1, 1)\n                        action.setTag(define.kBlinkActionTag);\n                        this.m_pGuideHintDest.node.runAction(new cc.repeatForever(action));\n\n                        // var urlPath = cc.url.raw(\"resources/playGamePic/hint_pointer.png\");\n                        // this.m_pGuideHintPointer.spriteFrame = new cc.SpriteFrame(urlPath);\n                        this.m_pGuideHintPointer.node.setScale(1, MyLayoutManager.getInstance().getVisibleRect().size.height / define.designSize.height);\n                        var self = this;\n                        var urlPath = (\"playGamePic/hint_pointer\");\n                        cc.loader.loadRes(urlPath, cc.SpriteFrame, function (err, spriteFrame) {\n                            self.m_pGuideHintPointer.spriteFrame = spriteFrame;\n                        });\n                    }\n\n                    this.updateHint();\n                    break;\n                }\n            }\n        }\n    },\n    //展现提示框图片\n    getHintDestFrameName: function (orientation, length) {\n        cc.log(\"调用getHintDestFrameName\")\n        if (orientation == define.kOrientation_Horizontal) {\n            return length == 2 ? \"bk_hint_dest2h\" : \"bk_hint_dest3h\";\n        }\n        else {\n            return length == 2 ? \"bk_hint_dest2v\" : \"bk_hint_dest3v\";\n        }\n    },\n\n    updateHint: function () {\n        cc.log(\"调用updateHint\")\n        var step = parseInt(this.m_pHintBlock.getOrientation() == define.kOrientation_Horizontal ? this.m_HintBlockDestCoordinate - this.m_pHintBlock.getGPosition().x : this.m_HintBlockDestCoordinate - this.m_pHintBlock.getGPosition().y);\n        var gpDest = this.m_pHintBlock.getGPosition();\n\n        var pointerRotation = 0;\n        if (this.m_pHintBlock.getOrientation() == define.kOrientation_Horizontal) {\n            gpDest.x += step;\n            pointerRotation = step > 0 ? 0 : 180;\n        }\n        else {\n            gpDest.y += step;\n            pointerRotation = step > 0 ? 270 : 90;\n        }\n        var offsetResolutionSize = cc.view.getVisibleSize();\n        this.m_pGuideHintDest.node.stopActionByTag(define.kBlinkActionTag);\n        var hideAction = cc.hide();\n        this.m_pGuideHintDest.node.runAction(hideAction);\n\n        var positionDest = this.getPosition(gpDest);\n        var centerOffset = new cc.Vec2(this.m_pHintBlock.getContentSize().width * this.m_pHintBlock.getScaleX() / 2, this.m_pHintBlock.getContentSize().height * this.m_pHintBlock.getScaleY() / 2);\n\n        // var urlPath = cc.url.raw(\"playGamePic/\" + this.getHintDestFrameName(this.m_pHintBlock.getOrientation(), this.m_pHintBlock.getLength()));\n\n        // this.m_pGuideHintDest.spriteFrame = new cc.SpriteFrame(urlPath);\n        var urlPath = (\"playGamePic/\" + this.getHintDestFrameName(this.m_pHintBlock.getOrientation(), this.m_pHintBlock.getLength()));\n        var self = this;\n        cc.loader.loadRes(urlPath, cc.SpriteFrame, function (err, spriteFrame) {\n            self.m_pGuideHintDest.spriteFrame = spriteFrame;\n        });\n\n        var Scale = new cc.Vec2(MyLayoutManager.getInstance().getGridSize().width / (91 + 4), MyLayoutManager.getInstance().getGridSize().height / (91 + 4));\n        this.m_pGuideHintDest.node.setScale(Scale)\n        this.m_pGuideHintDest.node.setPosition(new cc.Vec2(positionDest.x + centerOffset.x - offsetResolutionSize.width * 0.5, positionDest.y + centerOffset.y - offsetResolutionSize.height * 0.5));\n\n        var showAction = cc.show();\n        this.m_pGuideHintDest.node.runAction(showAction);\n        var actionBlick = new cc.blink(1, 1)\n        actionBlick.setTag(define.kBlinkActionTag);\n        this.m_pGuideHintDest.node.runAction(new cc.repeatForever(actionBlick));\n\n        var guideHintPointerPos = new cc.Vec2(this.m_pHintBlock.getAbsolutePosition().x + centerOffset.x - offsetResolutionSize.width * 0.5, this.m_pHintBlock.getAbsolutePosition().y + centerOffset.y - offsetResolutionSize.height * 0.5)\n        this.m_pGuideHintPointer.node.runAction(showAction.clone());\n\n        this.m_pGuideHintPointer.node.setPosition(guideHintPointerPos);\n        this.m_pGuideHintPointer.node.setRotation(pointerRotation);\n\n        // var dest_pos=this.m_pGuideHintDest.node.getPosition()\n        // this.m_pGuideHintPointer.node.setPosition(dest_pos);\n        // this.m_pGuideHintPointer.node.active=true;\n        this.m_pGuideHintPointer.node.stopActionByTag(define.kMoveActionTag);\n        this.m_pGuideHintPointer.node.opacity = 255;\n\n        var action1 = new cc.moveTo(0.7, this.m_pGuideHintDest.node.getPosition());\n        var action2 = new cc.fadeOut(0.5);\n        var action3 = new cc.fadeIn(0.0);\n        var action4 = new cc.moveTo(0.0, this.m_pGuideHintPointer.node.getPosition());\n        var action = new cc.repeatForever(cc.sequence(action1, action2, action3, action4));\n        action.setTag(define.kMoveActionTag);\n        this.m_pGuideHintPointer.node.runAction(action);\n\n    },\n    //金币提示按钮事件\n    getHintCallback() { \n        this.playClick();\n        if (Block.getCurrentTouchedBlock()) {\n            return;\n        };\n       \n        if (this.m_HintMode) { }\n        else if (!GameDataManager.getInstance().getgold() > 0) {\n            cc.log(\"nomoney!\")\n        }\n        else {\n            cc.log(\"金币提示\")\n            this.scheduleOnce(function () {\n                this.startFindSolution();\n            }, 0);\n            define.money -= 50;\n            // cc.sys.localStorage.setItem(\"gold\",define.money)\n            GameDataManager.getInstance().savegold(define.money);\n            this.node.emit(\"updatemoney\");\n        }\n\n    },\n    gold_btnClick() {\n        this.playClick();\n        //去看视频\n        // AdsManager.getInstance().showRewardedGold();\n    },\n    gold_btnCallback(){\n        define.money += 50;\n        // cc.sys.localStorage.setItem(\"gold\",define.money)\n        GameDataManager.getInstance().savegold(define.money);\n        this.node.emit(\"updatemoney\");\n    },\n    videohint_btnClick() {\n        this.playClick();\n        //去看视频\n        // AdsManager.getInstance().showRewardedVideo();\n    },\n   videohint_btnCallback(){\n        this.scheduleOnce(function () {\n            this.startFindSolution();\n        }, 0);\n    },\n    //触摸监听\n    add_touch_listeners: function () {\n        var self = this;\n        var canvas = cc.find(\"Canvas\");\n\n        canvas.on(cc.Node.EventType.TOUCH_START, function (event) {\n            var touches = event.getTouches();     //touches获取触控数组\n            var touchLoc = touches[0].getLocation();//touchLoc第一个触控点的世界地图坐标（node.convertToNodeSpaceAR()可以将世界地图坐标转换为node的局部坐标）\n\n            console.log(\"  touch  start\" + \"=\" + touchLoc.x + \",\" + touchLoc.y);\n\n        }, self.node);\n\n        canvas.on(cc.Node.EventType.TOUCH_MOVE, function (event) {\n            var touches = event.getTouches();\n            var touchLoc = touches[0].getLocation();\n\n            console.log(\"  touch  move\" + \"=\" + touchLoc.x + \",\" + touchLoc.y);\n        }, self.node);\n\n        canvas.on(cc.Node.EventType.TOUCH_END, function (event) {\n            var touches = event.getTouches();\n            var touchLoc = touches[0].getLocation();\n\n            console.log(\"  touch  end\" + \"=\" + touchLoc.x + \",\" + touchLoc.y);\n        }, self.node);\n\n    },\n    //记录游戏开始时间  \n    update(dt) {\n        // this.gold_lab.string=define.money;\n        {\n            var secondTime = parseInt(this.getPassTime()); // 秒\n            var minuteTime = 0;// 分\n            var hourTime = 0;// 时\n            // var dayTime = 0;// 天\n            if (secondTime < 60) {\n                secondTime = secondTime > 9 ? secondTime : \"0\" + secondTime;\n                this.timeLab.getComponent(cc.Label).string = \"00:\" + secondTime;\n            }\n            else {\n                if (secondTime >= 60 & secondTime < 3600) {\n                    minuteTime = parseInt(secondTime / 60)\n                    secondTime = parseInt(secondTime % 60)\n                    secondTime = secondTime > 9 ? secondTime : \"0\" + secondTime;\n                    minuteTime = minuteTime > 9 ? minuteTime : \"0\" + minuteTime;\n                    this.timeLab.getComponent(cc.Label).string = minuteTime + \":\" + secondTime;\n                }\n                else if (secondTime >= 3600) {\n                    hourTime = parseInt(secondTime / 3600)\n                    minuteTime = parseInt((secondTime % 3600) / 60)\n                    secondTime = parseInt((secondTime % 3600) % 60)\n                    secondTime = secondTime > 9 ? secondTime : \"0\" + secondTime;\n                    minuteTime = minuteTime > 9 ? minuteTime : \"0\" + minuteTime;\n                    hourTime = hourTime > 9 ? hourTime : \"0\" + hourTime;\n                    this.timeLab.getComponent(cc.Label).string = hourTime + \":\" + minuteTime + \":\" + secondTime;\n                }\n            }\n        }\n    },\n    //获取当前时间\n    getNowTime() {\n        var testDate = new Date();\n        //获取当前时间(从1970.1.1开始的毫秒数)\n        console.log('date ' + testDate.getTime());\n        cc.log(testDate);\n        return testDate.getTime();\n    },\n    //获取过去的秒数\n    getPassTime: function () {\n        var nowDate = new Date();\n        var passTime = nowDate - this.curDate;\n        // this.curDate = nowDate;\n        var passtime = passTime / 1000;\n        return passtime;\n    },\n    //菜单按钮\n    menu_btnClick() {\n        this.playClick();\n        this.menu_btn.node.active = false;\n        this.back_menu_btn.node.active = true;\n        this.main_btn.node.active = true;\n        this.stage_btn.node.active = true;\n        this.sub_gameTitle.node.active = false;\n    },\n    //返回菜单按钮\n    back_menu_btnClick() {\n        this.playClick();\n        this.menu_btn.node.active = true;\n        this.sub_gameTitle.node.active = true;\n        this.back_menu_btn.node.active = false;\n        this.main_btn.node.active = false;\n        this.stage_btn.node.active = false;\n    },\n    //进入关卡界面按钮\n    stage_btnClick() {\n        this.playClick();\n        cc.director.loadScene(\"ChooseStageScene\");\n    },\n    //进入主界面按钮\n    main_btnClick() {\n        this.playClick();\n        cc.director.loadScene(\"main\");\n\n    },\n    //重试\n    retryCallback: function () {\n        console.log(\" click retryCallback\");\n        this.playClick();\n        cc.director.loadScene(\"game\");\n    },\n    //音频\n    playClick: function () {\n        if (this.audioControl) {\n            this.audioControl.playClick();\n        } else {\n            console.log(\"audioControl null click playClick\");\n        }\n    },\n    playMove: function () {\n        if (this.audioControl) {\n            this.audioControl.playMove();\n        }\n    },\n    playComplete: function () {\n        if (this.audioControl) {\n            this.audioControl.playComplete();\n        }\n    },\n\n});\n"]}