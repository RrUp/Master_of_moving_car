{"version":3,"sources":["../../../../assets/Scripts/assets/Scripts/GameDataManagerJS.js"],"names":["RAW_RES","RAW_RES_PATH","PACKGE_STRING","languageTextList","ch","en","LevelData","require","subBlockStatusData","define","PackageDatas","cc","Class","properties","m_subPackageDatas","GameInfo","icon_url","appid","GameDataManager","extends","Component","gameName","PACAKGE_COUNT","MaxCustomsPass","m_curLevelNum","curDate","gamePlayScene_isReload","gameBox_pos","debugInfo","m_PackageStageCount","Integer","m_PackageDatas","m_gameBoxInfoList","ctor","i","getPackageCount","Date","statics","_instance","getInstance","start","getStageCount","packages","StageCount","length","initPackageData","getMaxUnlockedStage","count","stageCount","isCompleted","Default_Open","addCompletedStageCount","getCompletedStageCount","key","toString","sys","localStorage","setItem","val","getItem","parseInt","getStageData","stage","log","curLevelData","saveGameState","getGameState","savegold","money","getgold","saveskinlock","flag","getskinlock","savecarskin","carskin","getcarskin","state","getCompleteStars","getPackagesCompleteStars","startNum","tempNum","getGameCompleteStars","maxPackages","addGoals","CC_WECHATGAME","window","wx","postMessage","messageType","MAIN_MENU_NUM","RankKey","score","console","goals","getGoals","saveLatestPackage","getLatestPackage","pszFileName","url","_type","RawAsset","loader","loadRes","err","res","json","parePackageData","StageId","j","StageData","level","minmove","k","m_BlockData","coordinate","getPackgeStr","setGameCurLevelNum","levelNum","getGameCurLevelNum","saveSelectLevelPos","pos","getSelectLevelPos","setStagePageScollPos","curPackage","x","y","getStagePageScollPos","xVal","yVal","Vec2","preLoadingdata","maxPackageCount","passCount","unlockCount","getIsFistPlay","getResName","name","filePath","CUR_LANGUAGE_TYPE","LANGUAGE_CH","LANGUAGE_EN","getTextById","id","text","setGamePlaySceneReload","getGamePlaySceneReload","loadGameBoxWXInfo","pushSubGameInfoToGameBoxList","subGameInfo","push","clearAllGameInfoToGameBoxList","randGetGameInfoByGameBoxList","APP_ID","LoadGameInfoByDataJson","json_string","data_json","JSON","parse","list_size","data","navigatorIcon","setDebugInfo","info","getDebugInfo","GetSendErrorMsgRequestStr","errorMsg","errorMsg_request","String","GetUtcStamp","stringify","sendErrorMsg","requestUrl","buf","request","header","method","success","fail","xhr","getXMLHttpRequest","onreadystatechange","readyState","status","response","responseText","open","setRequestHeader","send","module","exports"],"mappings":"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","file":"GameDataManagerJS.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["\nlet RAW_RES = [\"p0\", \"p1\", \"p2\", \"p3\", \"p4\", \"p5\", \"p6\", \"p7\"];//??????\n\nlet RAW_RES_PATH = [\"dataA0\", \"dataB0\", \"dataC0\", \"dataD0\"];\nlet PACKGE_STRING = [\"简单\", \"中等\", \"困难\", \"专家\"];\n\nvar languageTextList = [\n    { ch: '中文', en: 'English' },\n    { ch: '载入进度', en: 'Loading' },\n    { ch: '过关', en: 'GOAL' },\n    { ch: '控制', en: 'CONTROL' },\n    { ch: '纵向的汽车', en: 'VERTICAL CARS' },\n    { ch: '横向的汽车', en: 'HORIZONTAL CARS' },\n    { ch: '关卡', en: 'PUZZLE' },\n    { ch: '简单', en: 'EASY' },\n    { ch: '中等', en: 'MEDIUM' },\n    { ch: '困难', en: 'HARD' },\n    { ch: '专家', en: 'EXPERT' },\n    { ch: '求助 遇到困难了 快来帮帮我', en: 'asking for help' },\n    { ch: ' 关卡 ', en: ' LEVEL ' },\n    { ch: '提示  x', en: 'HINT  x' },\n    { ch: '撤回', en: 'UNDO' },\n    { ch: '重试', en: 'RETRY' },\n    { ch: '暂停', en: 'PAUSE' },\n    { ch: '和好友一起闯关吧', en: 'play with friends ' },\n    { ch: '提示', en: 'HINT' },\n];\nvar LevelData = require(\"LevelDataJS\");//一个关卡下的地图数据\nvar subBlockStatusData = require(\"subBlockStatusDataJS\");//一块方块的信息\nvar define = require(\"define\");\n\nlet PackageDatas = cc.Class({\n    properties: {\n        m_subPackageDatas: [LevelData]\n    }\n});\n\nlet GameInfo = cc.Class({\n    properties: {\n        icon_url: \"\",\n        appid: \"\"\n    }\n});\n\nlet GameDataManager = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        gameName: \"unBlock_\",\n        PACAKGE_COUNT: 4,//4个难度\n        MaxCustomsPass: define.MaxCustomsPass,//100最大关卡\n        m_curLevelNum: 0,\n        curDate: 0,\n        gamePlayScene_isReload: false,\n\n        gameBox_pos: 0,\n        debugInfo: 'debuginfo',\n\n        m_PackageStageCount: [cc.Integer], //PACAKGE_COUNT\n        m_PackageDatas: [PackageDatas],   //PACAKGE_COUNT\n\n        //存储游戏盒子中 的其他游戏信息\n        m_gameBoxInfoList: [GameInfo],\n    },\n    ctor: function () {\n        for (var i = 0; i < this.getPackageCount(); ++i) {\n            this.m_PackageStageCount[i] = 0;\n\n            this.m_PackageDatas[i] = new PackageDatas();\n        }\n        this.curDate = new Date();\n    },\n\n    statics: {\n        _instance: null,\n        getInstance: function () {\n            if (GameDataManager._instance === null) {\n                this._instance = new GameDataManager();\n            }\n            return GameDataManager._instance;\n        }\n    },\n    // onLoad () {},\n\n    start() {\n    },\n    getPackageCount: function () {\n        return this.PACAKGE_COUNT\n    },\n\n    getStageCount: function (packages) {\n        if (packages >= 0 && packages < this.getPackageCount()) {\n            var StageCount = this.m_PackageDatas[packages].m_subPackageDatas.length;\n            if (StageCount <= 0) {\n                this.initPackageData(packages);\n            }\n            if (StageCount > this.MaxCustomsPass) {\n                return this.MaxCustomsPass;\n            } else {\n                return StageCount;\n            }\n        }\n        return 0\n    },\n//锁的最大关卡数\n    getMaxUnlockedStage: function (packages) {\n        var count = 0;\n        var stageCount = this.getStageCount(packages);\n        for (var i = 0; i < stageCount; i++) {\n            if (!this.isCompleted(packages, i)) {\n                count++;\n                if (count == define.Default_Open)  // 默认开启\n                {\n                    return i;\n                }\n            }\n        }\n        return stageCount - 0;\n    },\n//存入新完成的关卡\n    addCompletedStageCount: function (packages) {\n        let count = this.getCompletedStageCount(packages);\n        if (count < this.getStageCount(packages)) {\n            count++;\n            let key = this.gameName + \"package_\" + packages.toString()\n            cc.sys.localStorage.setItem(key, count);\n        }\n        return count;\n    },\n    // update (dt) {},\n//获取packages\ngetCompletedStageCount: function (packages) {\n    let key = this.gameName + \"package_\" + packages.toString()\n    let val = cc.sys.localStorage.getItem(key)\n    if ((val == null) || (val.length == 0)) {\n        val = 0;\n    }\n    return parseInt(val)\n},\n//获取关卡数据？？？？\ngetStageData: function (packages, stage) {\n    cc.log(\"this.m_PackageStageCount[packages]:\",this.m_PackageStageCount[packages]);\n    cc.log(\"this.m_PackageDatas[packages].m_subPackageDatas.length;\",this.m_PackageDatas[packages].m_subPackageDatas.length)\n\ncc.log(\"this.m_PackageDatas[packages].m_subPackageDatas[stage]\",this.m_PackageDatas[packages].m_subPackageDatas[stage])\n   \n    if (packages > 10) {              //为什么减一次10？？？？？？？？？？\n        packages -= 10;\n    }\n if (packages >= 0 && packages < this.getPackageCount()) {\n        var StageCount = this.m_PackageDatas[packages].m_subPackageDatas.length;\n        if (StageCount == 0) {\n            this.initPackageData(packages);\n        }\n\n        if (stage >= 0 && stage < this.m_PackageStageCount[packages]) {\n            var curLevelData = this.m_PackageDatas[packages].m_subPackageDatas[stage];\n            // return this.m_PackageDatas[packages].m_subPackageDatas[stage];\n           return curLevelData;   //这样可？？？？？？？？？？？？？？\n        }\n    }\n    return null;\n},\n//记录游戏关卡数据\nsaveGameState: function (packages, stage, val) {\n    if (!this.isCompleted(packages, stage)) {\n        this.addCompletedStageCount(packages);\n    }\n    let key = this.gameName + \"package\" + packages + \"stage\" + stage;\n    cc.sys.localStorage.setItem(key, val);\n},\n//获取游戏关卡数据\ngetGameState: function (packages, stage) {\n    let key = this.gameName + \"package\" + packages + \"stage\" + stage;\n    var val = cc.sys.localStorage.getItem(key);\n    if ((val == null) || (val.length == 0)) {\n        val = -1;\n    }\n    return parseInt(val)\n},\n//金币\nsavegold:function(money){\n    let key = \"gold\";\n    \n    cc.sys.localStorage.setItem(key,money);\n    cc.log(\"money\",money)\n},\ngetgold:function(){\n    let key = \"gold\";\n    var money=cc.sys.localStorage.getItem(key);\n    return parseInt(money);\n \n},\nsaveskinlock:function(i,flag){\n    let key = \"skin\"+i;\n    cc.sys.localStorage.setItem(key,flag);\n},\ngetskinlock:function(i){\n    let key =  \"skin\"+i;\n    var flag=cc.sys.localStorage.getItem(key);\n    return parseInt(flag)\n    \n},\nsavecarskin:function(carskin){\n    let key = \"carskin\";\n    cc.sys.localStorage.setItem(key,carskin);\n},\ngetcarskin:function(){\n    let key = \"carskin\";\n    var carskin=cc.sys.localStorage.getItem(key);\n    return parseInt(carskin);\n},\n//bool关卡completed \nisCompleted: function (packages, stage) {\n    if (packages >= 0 && packages < this.getPackageCount() && stage >= 0 && stage < this.m_PackageStageCount[packages]) {\n        var state = this.getGameState(packages, stage);\n        if (state > 0) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n    return false;\n},\n//获取state？和getGameState有什么区别？？\ngetCompleteStars: function (packages, stage) {\n\n    if (packages >= 0 && packages < this.getPackageCount() && stage >= 0 && stage < this.m_PackageStageCount[packages]) {\n        var state = this.getGameState(packages, stage);\n        return state;\n    }\n    return 0;\n},\n//返回startnum\ngetPackagesCompleteStars: function (packages) {\n    var startNum = 0;\n    var tempNum = 0;\n    for (var i = 0; i < this.m_PackageStageCount[packages]; ++i) {\n        tempNum = this.getCompleteStars(packages, i)\n        if (tempNum > 0) {\n            startNum += tempNum;\n        }\n    }\n    return startNum;\n},\n\ngetGameCompleteStars: function () {\n    var maxPackages = this.getPackageCount()\n    var startNum = 0;\n    var tempNum = 0;\n    for (var i = 0; i < maxPackages; ++i) {\n        tempNum = this.getPackagesCompleteStars(i);\n        if (tempNum > 0) {\n            startNum += tempNum;\n        }\n    }\n    return startNum;\n},\n//增加goals\naddGoals: function () {\n    let key = this.gameName + \"goals2\";\n    if (CC_WECHATGAME) {\n        window.wx.postMessage({\n            messageType: 3,\n            MAIN_MENU_NUM: define.RankKey,\n            score: 0,\n            // score: this.getGoals() + 1,\n        });\n    } else {\n        console.log(\"fail 提交得分 : \" + goals)\n    }\n    \n    cc.sys.localStorage.setItem(key, this.getGoals() + 1);\n\n\n},\n//获取goals\ngetGoals: function () {\n    let key = this.gameName + \"goals2\";\n    var val = cc.sys.localStorage.getItem(key);\n    if ((val == null) || (val.length == 0)) {\n        val = 0;\n    }\n    return parseInt(val)\n},\n//记录当前页面（难度latestpackage）\nsaveLatestPackage: function (packages) {\n    let key = this.gameName + \"latestPackage\"\n    cc.sys.localStorage.setItem(key, packages.toString());\n},\ngetLatestPackage: function () {\n    let key = this.gameName + \"latestPackage\" // packages.toString()\n    var val = cc.sys.localStorage.getItem(key);\n    if ((val == null) || (val.length == 0)) {\n        val = 0;\n    }\n    return parseInt(val);\n},\n\ninitPackageData: function (packages) {\n    let pszFileName = \"resources/stageData/\" + RAW_RES_PATH[packages];\n    pszFileName = \"stageData/\" + RAW_RES_PATH[packages];\n    //读取game data .json文件\n    var url = pszFileName, _type = cc.RawAsset;\n    //得到json文件内容\n    cc.loader.loadRes(url, _type, function (err, res) {\n        if (err) {\n            //这里获取res内容就是json里的内容\n            console.log(\" err=\" + err);\n\n        } else {\n            //这里获取res内容就是json里的内容\n            console.log(\"init \" + pszFileName + \"  res.StageCount=\" + res.json.StageCount);\n\n            GameDataManager.getInstance().parePackageData(res.json);\n        }\n    });\n    this.m_PackageStageCount[packages] = this.MaxCustomsPass;\n},\n//解析json数据文件\nparePackageData: function (res) {\n   \n    let i = res.StageId;\n\n    for (let j = 0; j < res.StageData.length; ++j) {\n        let level = res.StageData[j].level;\n        //    console.log(i+\"， level=\" + level);\n        this.m_PackageDatas[i].m_subPackageDatas[j] = new LevelData();\n        this.m_PackageDatas[i].m_subPackageDatas[j].minmove = res.StageData[j].minmove;\n        this.m_PackageDatas[i].m_subPackageDatas[j].count = res.StageData[j].count;\n \n        for (let k = 0; k < res.StageData[j].count; ++k) {\n            this.m_PackageDatas[i].m_subPackageDatas[j].m_BlockData[k] = new subBlockStatusData()\n            this.m_PackageDatas[i].m_subPackageDatas[j].m_BlockData[k].coordinate = res.StageData[j].subBlockStatusData[k].coordinate;\n            this.m_PackageDatas[i].m_subPackageDatas[j].m_BlockData[k].state = res.StageData[j].subBlockStatusData[k].state;\n        }\n        //   console.log(i+\"， res.StageData[j].count=\" + res.StageData[j].count);\n    }\n    console.log(i + \", level.count=\" + res.StageData.length);\n},\n\ngetPackgeStr: function (i) {\n    if (i >= 0 && i < PACKGE_STRING.length) {\n        return PACKGE_STRING[i];\n    }\n    return 0;\n},\n// //设置游戏主题\n// setGameTheme: function (val) {\n//     // 0-3 \n//     var i = parseInt(val);\n//     let key = this.gameName + \"GameTheme\"\n//     cc.sys.localStorage.setItem(key, i.toString());\n// },\n// //获取当前主题，没有为0.返回主题id\n// getGameTheme: function () {\n//     let key = this.gameName + \"GameTheme\"\n//     var val = cc.sys.localStorage.getItem(key);\n//     if ((val == null) || (val.length == 0)) {\n//         val = 0;\n//     }\n//     return parseInt(val);\n// },\n\n//记录关卡id\nsetGameCurLevelNum: function (levelNum) {\n    this.m_curLevelNum = levelNum;\n},\n//返回关卡id\ngetGameCurLevelNum: function () {\n    return this.m_curLevelNum;\n},\n\n//记录难度选择界面LevelPos  \nsaveSelectLevelPos: function (pos) {\n    let key = this.gameName + \"SelectLevelPos\"\n    cc.sys.localStorage.setItem(key, pos.toString());\n},\ngetSelectLevelPos: function () {\n    let key = this.gameName + \"SelectLevelPos\"\n    var val = cc.sys.localStorage.getItem(key);\n    if ((val == null) || (val.length == 0)) {\n        val = 0;\n    }\n    return parseInt(val);\n},\n\n//记录不同难度 关卡选择界面 滑动页面的 下标位置 (A123 B123 C123)\nsetStagePageScollPos: function (pos) {\n    var curPackage = this.getLatestPackage();\n\n    let key = this.gameName + \"stagePageScollPosX\" + curPackage.toString();\n    cc.sys.localStorage.setItem(key, pos.x.toString());\n\n    key = this.gameName + \"stagePageScollPosY\" + curPackage.toString();\n    cc.sys.localStorage.setItem(key, pos.y.toString());\n},\ngetStagePageScollPos: function () {\n    var curPackage = this.getLatestPackage();\n    let key = this.gameName + \"stagePageScollPosX\" + curPackage.toString();\n\n    var xVal = cc.sys.localStorage.getItem(key);\n    if ((xVal == null) || (xVal.length == 0)) {\n        xVal = 0;\n    }\n    key = this.gameName + \"stagePageScollPosY\" + curPackage.toString();\n    var yVal = cc.sys.localStorage.getItem(key);\n    if ((yVal == null) || (yVal.length == 0)) {\n        yVal = 0;\n    }\n    return new cc.Vec2(parseInt(xVal), parseInt(yVal));\n},\n\npreLoadingdata: function () {\n\n    let maxPackageCount = this.getPackageCount();//4个难度\n    for (let i = 0; i < maxPackageCount; i++) {\n        let passCount = this.getCompletedStageCount(i);\n        let unlockCount = this.getMaxUnlockedStage(i);//有什么区别？后边用过吗？\n    }\n},\n    //bool第一次玩\n    getIsFistPlay: function () {\n\n        if (GameDataManager.getInstance().getGoals() > 0) {\n            return false;\n        } else {\n            return true;\n        }\n    },\n    //返回路径和（中英）name\n    getResName: function (name) {\n\n        var filePath = '';\n        if (define.CUR_LANGUAGE_TYPE == define.LANGUAGE_CH) {\n            filePath = 'ch/';\n        } else if (define.CUR_LANGUAGE_TYPE == define.LANGUAGE_EN) {\n            filePath = 'en/';\n        }\n        return filePath + name;\n    },\n//中英id找text\n    getTextById: function (id) {\n        if ((id >= 0) && (id < languageTextList.length)) {\n            var text = '';\n            if (define.CUR_LANGUAGE_TYPE == define.LANGUAGE_CH) {\n                text = languageTextList[id].ch;\n            } else if (define.CUR_LANGUAGE_TYPE == define.LANGUAGE_EN) {\n                text = languageTextList[id].en;\n            }\n            return text;\n        }\n    },\n//设置游戏场景加载的标记\n    setGamePlaySceneReload: function (flag) {\n        this.gamePlayScene_isReload = flag;\n    },\n//初始为false\n    getGamePlaySceneReload: function () {\n        return this.gamePlayScene_isReload;\n    },\n\n    loadGameBoxWXInfo: function () {\n\n        // var CC_WECHATGAME = true;\n        if (CC_WECHATGAME) {\n            //show other game\n            //下载 含有游戏信息列表的 json文件\n            // head=\"https://www.7cgames.cn/transfer.php?url=\"\n            // url=\"https://www.7cgames.cn/GameRes/fangyipengDir/7CGamesBoxWX/JsonData/7cgamesBoxData.json\"\n            // var urlPath = \"https://www.7cgames.cn/transfer.php?url=https://www.7cgames.cn/GameRes/fangyipengDir/7CGamesBoxWX/JsonData/7cgamesBoxData.json\"\n            // //7CGamesBoxWX/JsonData/7cgamesNavigator.json  7cgamesBoxDataShare.json\n            // urlPath = \"https://www.7cgames.cn/transfer.php?url=https://www.7cgames.cn/GameRes/7CGamesBoxWX/JsonData/7cgamesNavigator.json\"\n            // cc.loader.load(urlPath, function (err, res) {\n            //     if (err)\n            //         console.log('Completed with ' + err.length + ' errors');\n            //     else {\n            //         console.log(' loadGameBoxWXInfo 加载完成！');\n            //         GameDataManager.getInstance().LoadGameInfoByDataJson(res)\n            //     }\n            // });\n        }\n    },\n\n    pushSubGameInfoToGameBoxList: function (subGameInfo) {\n        this.m_gameBoxInfoList.push(subGameInfo)\n    },\n\n    clearAllGameInfoToGameBoxList: function (subGameInfo) {\n        this.m_gameBoxInfoList = [];\n    },\n\n    randGetGameInfoByGameBoxList: function () {\n        //从已有列表中随机取出一个游戏的信息\n        if (this.m_gameBoxInfoList.length <= 0) {\n            this.loadGameBoxWXInfo();\n        } else {\n            // var min = 0;\n            // var max = this.m_gameBoxInfoList.length;\n            // var result = min + Math.floor(Math.random() * (max - min + 1));\n            // return this.m_gameBoxInfoList[result]\n            // define.APP_ID\n            ++this.gameBox_pos;\n            this.gameBox_pos = this.gameBox_pos % (this.m_gameBoxInfoList.length + 1)\n            if (this.m_gameBoxInfoList[this.gameBox_pos].appid == define.APP_ID) {\n                ++this.gameBox_pos;\n                this.gameBox_pos = this.gameBox_pos % (this.m_gameBoxInfoList.length + 1)\n            } else {\n\n            }\n            console.log(' return pos = ' + this.gameBox_pos)\n            return this.m_gameBoxInfoList[this.gameBox_pos]\n        }\n    },\n\n    LoadGameInfoByDataJson: function (json_string) {\n\n        //解析下载的json文件 \n        //获取appid  icon图片地址\n        var data_json = JSON.parse(json_string);\n        var list_size = data_json.data.length;\n\n        // //json_文件中加入 default_icon_url_dir字段，避免固定死位置\n        // var default_icon_url_dir = \"https://www.7cgames.cn/GameRes/fangyipengDir/7CGamesBoxWX/game_icons_196_196\";\n\n        this.clearAllGameInfoToGameBoxList();\n\n        for (var i = 0; i < list_size; ++i) {\n            var subGameInfo = new GameInfo();\n            subGameInfo.icon_url = data_json.data[i].navigatorIcon\n            subGameInfo.appid = data_json.data[i].appid\n            if (subGameInfo.icon_url && subGameInfo.appid) {\n                this.m_gameBoxInfoList.push(subGameInfo)\n                //console.log(' icon_url  =' + subGameInfo.icon_url + ', appid =' + subGameInfo.appid);\n            }\n        }\n\n        console.log(' LoadGamesListDataJson size =' + this.m_gameBoxInfoList.length);\n    },\n\n    setDebugInfo: function (info) {\n        this.debugInfo = info;\n    },\n\n    getDebugInfo: function () {\n        return this.debugInfo;\n    },\n\n    //记录版本号\n    // setGameVersionNum: function (versionNum) {\n    //     let key = this.gameName + \"GameVersionNum\"\n    //     cc.sys.localStorage.setItem(key, versionNum.toString());\n    // },\n    // getGameVersionNum: function () {\n    //     let key = this.gameName + \"GameVersionNum\"\n    //     var val = cc.sys.localStorage.getItem(key);\n    //     if ((val == null) || (val.length == 0)) {\n    //         val = '';\n    //     }\n    //     return val.toString();\n    // },\n\n    // GetUtcStamp: function () {\n    //     // 毫秒\n    //     var time_stamp = new Date().getTime();\n    //     //秒\n    //     // var time_stamp_str = String(Date.parse(new Date()));\n    //     // var time_stamp = Number(time_stamp_str.substr(0, time_stamp_str.length - 3));\n    //     return time_stamp;\n    // },\n\n    GetSendErrorMsgRequestStr: function (errorMsg) {\n        var errorMsg_request =\n        {\n            \"gameName\": this.gameName,\n            \"msg\": errorMsg,\n            // \"timeStamp\": this.GetUtcStamp(),\n            \"time\": String(this.GetUtcStamp()),\n        }\n        return JSON.stringify(errorMsg_request);\n    },\n\n    sendErrorMsg: function (errorMsg) {\n\n        var requestUrl = 'http://192.168.1.108:8070/sendErrorMsg'\n        requestUrl = 'https://www.7cgames.cn:8070/sendErrorMsg'\n\n        if (CC_WECHATGAME) {\n            var buf = this.GetSendErrorMsgRequestStr(errorMsg)\n            wx.request({\n                url: requestUrl, // \n                data: buf,\n                header: {\n                    'content-type': 'application/json' // 默认值\n                },\n                method: 'POST',\n                success(res) {\n                    console.log(res)\n                },\n                fail(res) {\n                    console.log(res.data)\n                },\n            })\n        } else {\n            var xhr = cc.loader.getXMLHttpRequest();\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {\n                    //success\n                    console.log(\" readyState success: \")\n                } else {\n                    console.log(\" readyState error: \" + xhr.readyState + ',' + xhr.status)\n                }\n                var response = xhr.responseText;\n                console.log(\" response: \" + response)\n            };\n            // this.streamXHREventsToLabel(xhr, this.xhrAB, this.xhrABResp, \"POST\");\n            xhr.open(\"POST\", requestUrl);\n            //set Content-type \"text/plain\" to post ArrayBuffer or ArrayBufferView\n            // xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n            xhr.setRequestHeader(\"content-type\", \"application/json;charset=UTF-8\");\n            // xhr.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\n            // Uint8Array is an ArrayBufferView\n            var buf = this.GetSendErrorMsgRequestStr(errorMsg)\n\n            xhr.send(buf);\n            // xhr.send(new Uint8Array([1,2,3,4,5]));\n            // xhr.send(new Uint8Array(errorMsg_request));\n        }\n    }\n\n\n\n\n});\n\nmodule.exports = GameDataManager;"]}