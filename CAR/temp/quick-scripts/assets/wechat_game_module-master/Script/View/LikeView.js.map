{"version":3,"sources":["LikeView.js"],"names":["cc","Class","extends","Component","properties","idxList","set","v","setIdxList","get","getIdxList","onLoad","icons","node","children","len","Math","min","G","WECHAT","appIdList","length","moreGameIconList","start","onClick","e","target","idx","getSiblingIndex","lastIdx","lastAppId","navigateToMiniProgram","btn","getComponent","Button","interactable","nextIdx","getNextIdx","spriteFrame","log","scheduleOnce","Sprite","indexOf","CC_EDITOR","_idxList","sys","localStorage","setItem","JSON","stringify","Array","parse","getItem","i","push"],"mappings":"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","file":"LikeView.js","sourceRoot":"../../../../../../assets/wechat_game_module-master/Script/View","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        idxList: {\n            set(v) {\n                this.setIdxList(v)\n            },\n            get() {\n                return this.getIdxList()\n            }\n        }\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        this.icons = this.node.children[0].children\n        this.len = Math.min(G.WECHAT.appIdList.length, G.WECHAT.moreGameIconList.length)\n    },\n\n    start() {\n\n    },\n\n    onClick(e) {\n        let node = e.target\n        let idxList = this.idxList\n        let idx = node.getSiblingIndex()\n        let lastIdx = idxList[idx]\n        let lastAppId = G.WECHAT.appIdList[lastIdx % this.len]\n        G.WECHAT.navigateToMiniProgram(lastAppId)\n\n        let btn = node.getComponent(cc.Button)\n        btn.interactable = false\n\n        let nextIdx = this.getNextIdx(lastIdx)\n        let spriteFrame = G.WECHAT.moreGameIconList[nextIdx % this.len]\n        idxList[idx] = nextIdx\n\n        cc.log(\"idxList:\", idxList, \" lastIdx:\", lastIdx, \" nextIdx:\", nextIdx)\n        this.idxList = idxList\n        this.scheduleOnce(() => {\n            this.icons[idx].getComponent(cc.Sprite).spriteFrame = spriteFrame\n            btn.interactable = true\n        }, 2)\n    },\n\n    getNextIdx(idx) {\n        while (this.idxList.indexOf(idx) > -1) {\n            idx++\n            idx = idx % this.len\n        }\n        return idx\n    },\n\n    setIdxList(idxList) {\n        if (!CC_EDITOR) {\n            this._idxList = idxList\n            cc.sys.localStorage.setItem(\"idxList\", JSON.stringify(idxList))\n        }\n    },\n\n    getIdxList() {\n        if (!CC_EDITOR) {\n            if (this._idxList instanceof Array) return this._idxList\n            var idxList = JSON.parse(cc.sys.localStorage.getItem(\"idxList\"))\n            if (idxList) {\n                this._idxList = idxList\n            } else {\n                this._idxList = []\n                for(var i=0,len=this.icons.length;i<len;i++){\n                    this._idxList.push(i)\n                }\n            }\n            return this._idxList\n        }\n    },\n});\n"]}