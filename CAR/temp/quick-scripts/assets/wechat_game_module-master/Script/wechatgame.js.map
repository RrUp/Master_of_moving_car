{"version":3,"sources":["wechatgame.js"],"names":["miniProgramAppid","moreGameQRCodeUrl","url","server","gameName","appid","secret","MAIN_MENU_NUM","bannerAdUnitId","videoAdUnitId","config","shareTitleList","shareImgDir","shareImgType","moreGameIconDir","appIdList","random","len","Math","floor","wechatgame","self","isAndroid","cc","sys","os","OS_ANDROID","CC_WECHATGAME","wx","updateShareMenu","withShareTicket","showShareMenu","onShareAppMessage","r","length","str","wxDownloader","REMOTE_SERVER_ROOT","raw","title","imageUrl","onShow","onHide","getUserInfo","then","getOpenId","catch","console","log","e","launchOptions","getLaunchOptionsSync","bannerAdisLoad","videoAdisLoad","videoAdCallback","createBannerAd","createVideoAd","moreGameQRCodeIdx","moreGameIconList","moreGameQRCodeList","initMoreGame","proto","prototype","res","shareTicket","query","lastOffLineTime","Date","getTime","onHideCallback","Function","warn","login","Promise","resolve","reject","errcode","message","success","fail","openId","code","request","data","js_code","grant_type","header","method","res2","openid","getShareInfo","getDecryptedData","param","encryptedData","iv","getOpenGid","userInfo","getSetting","authSetting","createUserInfoButton","button","type","text","style","left","top","width","height","lineHeight","backgroundColor","color","textAlign","fontSize","borderRadius","onTap","hide","getServerUtc","shareAppMessage","flag","complete","setTimeout","createRewardedVideoAd","bannerAd","getSystemInfoSync","windowWidth","windowHeight","adUnitId","onLoad","onResize","realWidth","realHeight","onError","err","showBannerAd","show","hideBannerAd","videoAd","errMsg","onClose","isEnded","undefined","showVideoAd","load","submitScore","score","isNaN","postMessage","messageType","updateFriendRank","getMoreGameQRCodeData","loader","loadResDir","SpriteFrame","urls","sort","a","b","parseInt","name","headers","navigateToMiniProgram","appId","isMiniProgram","path","previewImage","idx","QRCode","module","exports"],"mappings":"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","file":"wechatgame.js","sourceRoot":"../../../../../assets/wechat_game_module-master/Script","sourcesContent":["const miniProgramAppid = \"wx361c9e49bd9033ca\"\nconst moreGameQRCodeUrl = \"https://www.7cgames.cn/GameRes/fangyipengDir/7CGamesBoxWX/QRCode/WXGamesCode.json\"\n\n// const url = \"http://192.168.0.108:18070/\"\nconst url = \"https://www.7cgames.cn:8070/\"\nvar server = url\n\nconst gameName = \"ball2\"\nconst appid = \"wx0a909849d3a53f25\"\nconst secret = \"1ad92b8df595f9ecd405ee122f7afe07\"\nconst MAIN_MENU_NUM = \"qr2\"\n\nconst bannerAdUnitId = \"adunit-a605a4125f3075f5\"\nconst videoAdUnitId = \"adunit-46ffe4d65d261222\"\n\nconst config = {\n    shareTitleList: ['两只猪的爱情故事，看完后泪流满面', '快滚，快滚！', '爱不爱我我都只是个球球', '这也太甜了吧！', '其实我想让你学习一下通关恋爱球球的秘诀'],  //分享标题数组\n    shareImgDir: 'resources/share/',                                            //分享图片目录\n    shareImgType: '.jpg',                                                       //分享图片类型\n    moreGameIconDir: 'more',                                                    //更多游戏icon目录\n    appIdList: [\n        \"wxd5a257d6ee2b8f91\",\n        \"wx515f44394eab5985\",\n        \"wx08beeb18dc512c2f\",\n        \"wxea245f85c9673414\",\n        \"wxc4e628aa7caa2c07\",\n        \"wx0af703a36035c60c\",\n        \"wxf49b0a26d9405058\",\n        \"wxac5820bc06a3a893\",\n        \"wxd9589cd7117d0873\"\n    ]\n}\n\nfunction random(len) {\n    return len === 0 ? -1 : Math.floor(Math.random() * len)\n}\n\nfunction wechatgame() {\n    var self = this\n    self.isAndroid = cc.sys.os === cc.sys.OS_ANDROID ? true : false\n\n    if (CC_WECHATGAME) {\n        wx.updateShareMenu({ withShareTicket: true })\n        wx.showShareMenu()\n        wx.onShareAppMessage(() => {\n            let r = random(config.shareTitleList.length)\n            let str = config.shareTitleList[r]\n            let url = wxDownloader.REMOTE_SERVER_ROOT + '/' + cc.url.raw(config.shareImgDir + str + config.shareImgType)\n            return {\n                title: str,\n                imageUrl: url\n            }\n        })\n        self.onShow()\n        self.onHide()\n        self.getUserInfo()\n            .then(() => {\n                return self.getOpenId()\n            })\n            .catch(e => console.log(e))\n        self.launchOptions = wx.getLaunchOptionsSync()\n        console.log(self.launchOptions)\n    }\n\n    self.bannerAdisLoad = false\n    self.videoAdisLoad = false\n    self.videoAdCallback = null\n    self.createBannerAd()\n    self.createVideoAd()\n\n    self.appIdList = config.appIdList\n    self.moreGameQRCodeIdx = 0\n    self.moreGameIconList = []\n    self.moreGameQRCodeList = []\n    self.initMoreGame()\n}\n\nvar proto = wechatgame.prototype\n\nproto.onShow = function () {\n    if (!CC_WECHATGAME) return\n    var self = this\n    wx.onShow(res => {\n        console.log(res)\n        self.shareTicket = res.shareTicket\n        self.query = res.query\n    })\n}\n\nproto.onHide = function () {\n    if (!CC_WECHATGAME) return\n    var self = this\n    wx.onHide(() => {\n        self.lastOffLineTime = new Date().getTime()\n        self.onHideCallback instanceof Function ? self.onHideCallback() : console.warn(\"onHideCallback not a function\")\n    })\n}\n\nproto.login = function () {\n    return new Promise((resolve, reject) => {\n        if (!CC_WECHATGAME) reject({ errcode: \"PLATFORM_ERROR\", message: \"wx为undefined\" })\n        wx.login({\n            success(res) {\n                resolve(res)\n            },\n            fail() {\n                reject({ errcode: \"LOGIN_FAIL\", message: \"login失败\" })\n            }\n        })\n    })\n}\n\nproto.getOpenId = function () {\n    var self = this\n    return new Promise((resolve, reject) => {\n        if (!CC_WECHATGAME) reject({ errcode: \"PLATFORM_ERROR\", message: \"wx为undefined\" })\n        if (self.openId) resolve()\n        //发起网络请求\n        self.login()\n            .then(res => {\n                if (!res.code) reject({ errcode: \"CODE_PARAM_ERROR\", message: \"code为null或undefined\" })\n                wx.request({\n                    url: server + \"getOpenId\",\n                    data: {\n                        gameName: gameName,\n                        appid: appid,\n                        secret: secret,\n                        js_code: res.code,\n                        grant_type: 'authorization_code'\n                    },\n                    header: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    method: 'POST',\n                    success(res2) {\n                        if (res2.data.openid) {\n                            self.openId = res2.data.openid\n                            resolve()\n                        } else {\n                            reject({ errcode: \"OPENID_PARAM_ERROR\", message: \"openId为null或undefined\" })\n                        }\n                    },\n                    fail() {\n                        reject({ errcode: \"GET_OPENID_FAIL\", message: \"请求getOpenId失败\" })\n                    }\n                })\n            })\n    })\n}\n\nproto.getShareInfo = function () {\n    var self = this\n    return new Promise((resolve, reject) => {\n        if (!self.shareTicket) reject({ errcode: \"SHARETICKET_PARAM_ERROR\", message: \"shareTicket为null或undefined\" })\n        if (!self.openId) reject({ errcode: \"OPENID_PARAM_ERROR\", message: \"openId为null或undefined\" })\n        wx.getShareInfo({\n            shareTicket: self.shareTicket,\n            success(res) {\n                resolve(res)\n            },\n            fail() {\n                reject({ errcode: \"GET_SHARE_INFO_FAIL\", message: \"getShareInfo失败\" })\n            }\n        })\n    })\n}\n\nproto.getDecryptedData = function (param) {\n    var self = this\n    param = param ? param : {}\n    return new Promise((resolve, reject) => {\n        if (!self.openId) reject({ errcode: \"OPENID_PARAM_ERROR\", message: \"openId为null或undefined\" })\n        if (!param.encryptedData) reject({ errcode: \"SHARE_INFO_PARAM_ERROR\", message: \"encryptedData为null或undefined\" })\n        if (!param.iv) reject({ errcode: \"SHARE_INFO_PARAM_ERROR\", message: \"iv为null或undefined\" })\n        wx.request({\n            url: server + \"getDecryptedData\",\n            data: {\n                openId: self.openId,\n                encryptedData: param.encryptedData,\n                iv: param.iv,\n            },\n            header: {\n                \"Content-Type\": \"application/json\"\n            },\n            method: 'POST',\n            success(res) {\n                resolve(res)\n            },\n            fail() {\n                reject({ errcode: \"GET_DECRYPTED_DATA_FAIL\", message: \"请求getDecryptedData失败\" })\n            }\n        })\n    })\n}\n\nproto.getOpenGid = function () {\n    var self = this\n    return new Promise((resolve, reject) => {\n        self.getOpenId()\n            .then(() => {\n                return self.getShareInfo()\n            })\n            .then(res => {\n                return self.getDecryptedData({ openId: self.openId, encryptedData: res.encryptedData, iv: res.iv })\n            })\n            .then(res => resolve(res))\n    })\n}\n\nproto.getUserInfo = function () {\n    var self = this\n    return new Promise((resolve, reject) => {\n        if (!CC_WECHATGAME) reject({ errcode: \"PLATFORM_ERROR\", message: \"wx为undefined\" })\n        if (self.userInfo) resolve()\n        wx.getSetting({\n            success(res) {\n                if (!res.authSetting['scope.userInfo'] && wx.createUserInfoButton) {\n                    let button = wx.createUserInfoButton({\n                        type: 'text',\n                        text: '',\n                        style: {\n                            left: 0,\n                            top: 0,\n                            width: 5000,\n                            height: 5000,\n                            lineHeight: 40,\n                            backgroundColor: '',\n                            color: '',\n                            textAlign: 'center',\n                            fontSize: 16,\n                            borderRadius: 4\n                        }\n                    })\n\n                    button.onTap((res2) => {\n                        button.hide();\n                        self.userInfo = res2.userInfo\n                        resolve()\n                    })\n                } else {\n                    wx.getUserInfo({\n                        success(res2) {\n                            self.userInfo = res2.userInfo\n                            resolve()\n                        },\n                        fail() {\n                            reject({ errcode: \"GET_USER_INFO_FAIL\", message: \"获取userInfo失败\" })\n                        }\n                    });\n                }\n            },\n            fail() {\n                reject({ errcode: \"GET_SETTING_FAIL\", message: \"获取Setting失败\" })\n            }\n        })\n    })\n}\n\nproto.getServerUtc = function () {\n    return new Promise((resolve, reject) => {\n        wx.request({\n            url: server + \"getServerUtc\",\n            method: 'POST',\n            success(res) {\n                resolve(res)\n            },\n            fail() {\n                reject({ errcode: \"GET_OPENID_FAIL\", message: \"请求getServerUtc失败\" })\n            }\n        })\n    })\n}\n\nproto.shareAppMessage = function (param) {\n    param = param ? param : {}\n    return new Promise((resolve, reject) => {\n        let flag = false\n        let r = random(config.shareTitleList.length)\n        let str = param.str ? param.str : config.shareTitleList[r]\n        let url = param.url ? param.url : wxDownloader.REMOTE_SERVER_ROOT + '/' + cc.url.raw(config.shareImgDir + str + config.shareImgType)\n        let query = param.query ? param.query : ''\n        wx.shareAppMessage({\n            title: str,\n            imageUrl: url,\n            query: query,\n            success(res) {\n                console.log(\"success\", res)\n                resolve()\n            },\n            fail(e) {\n                console.log(\"fail\", e)\n                reject()\n            },\n            complete() {\n                console.log(\"complete\", e)\n                flag = true\n            }\n        })\n        setTimeout(() => {\n            if (!flag)\n                resolve()\n        }, 2000)\n    })\n}\n\nproto.createBannerAd = function () {\n    if (CC_WECHATGAME && wx.createRewardedVideoAd) {\n        var self = this\n        if (!self.bannerAd) {\n            let width = wx.getSystemInfoSync().windowWidth\n            let height = wx.getSystemInfoSync().windowHeight\n\n            self.bannerAd = wx.createBannerAd({\n                adUnitId: bannerAdUnitId,\n                style: {\n                    left: 0,\n                    top: height - 130,\n                    height: 130,\n                }\n            })\n\n            self.bannerAd.onLoad(() => {\n                self.bannerAdisLoad = true\n            })\n\n            self.bannerAd.onResize(res => {\n                self.bannerAd.style.left = (width - self.bannerAd.style.realWidth) / 2;\n                self.bannerAd.style.top = height - self.bannerAd.style.realHeight;\n            })\n\n            self.bannerAd.onError(err => { console.log(err) })\n        }\n    }\n}\n\nproto.showBannerAd = function () {\n    var self = this\n    if (CC_WECHATGAME && wx.createRewardedVideoAd) {\n        if (!self.bannerAd) {\n            self.createBannerAd()\n        }\n        self.bannerAd.show()\n    }\n}\n\nproto.hideBannerAd = function () {\n    var self = this\n    if (CC_WECHATGAME && wx.createRewardedVideoAd) {\n        if (!self.bannerAd) {\n            self.createBannerAd()\n        }\n        self.bannerAd.hide()\n    }\n}\n\nproto.createVideoAd = function () {\n    if (CC_WECHATGAME && wx.createRewardedVideoAd) {\n        var self = this\n        if (!self.videoAd) {\n            self.videoAd = wx.createRewardedVideoAd({\n                adUnitId: videoAdUnitId\n            });\n\n            self.videoAd.onLoad(() => {\n                self.videoAdisLoad = true;\n                console.log('激励视频 广告加载成功')\n            });\n\n            self.videoAd.onError(err => {\n                console.log(err.errMsg);\n            });\n\n            self.videoAd.onClose(res => {\n                self.videoAdisLoad = false;\n                if (res && res.isEnded || res === undefined) {\n                    self.videoAdCallback instanceof Function ? self.videoAdCallback() : console.err(\"videoAdCallback is not a function\")\n                }\n            });\n        }\n    }\n}\n\nproto.showVideoAd = function () {\n    var self = this\n    if (CC_WECHATGAME && wx.createRewardedVideoAd) {\n        if (!self.videoAd) {\n            self.createVideoAd()\n        }\n        self.videoAd.show()\n            .catch(e => {\n                console.log(e)\n                self.videoAd.load()\n                    .then(() => self.videoAd.show())\n            })\n    }\n}\n\nproto.submitScore = function (score) {\n    if (!isNaN(score)) {\n        wx.postMessage({\n            messageType: 3,\n            MAIN_MENU_NUM: MAIN_MENU_NUM,\n            score: score,\n        });\n    }\n}\n\nproto.updateFriendRank = function () {\n    wx.postMessage({\n        messageType: 1,\n        MAIN_MENU_NUM: \"qr2\"\n    });\n}\n\nproto.initMoreGame = function () {\n    var self = this\n    if (CC_WECHATGAME && self.moreGameQRCodeList.length === 0)\n        self.getMoreGameQRCodeData()\n            .then(res => self.moreGameQRCodeList = res.data.data)\n    if (self.moreGameIconList.length === 0)\n        cc.loader.loadResDir(config.moreGameIconDir, cc.SpriteFrame, function (e, res, urls) {\n            if (e)\n                return console.log(e)\n            self.moreGameIconList = res.sort((a, b) => { return parseInt(a.name) - parseInt(b.name) })\n        })\n}\n\nproto.getMoreGameQRCodeData = function () {\n    return new Promise((resolve, reject) => {\n        wx.request({\n            url: moreGameQRCodeUrl,\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            success(res) {\n                resolve(res);\n            },\n            fail(e) {\n                reject(e)\n            }\n        })\n    })\n}\n\nproto.navigateToMiniProgram = function (appId) {\n    if (!CC_WECHATGAME) return\n    var isMiniProgram = appId ? false : true\n    appId = isMiniProgram ? miniProgramAppid : appId\n    if (wx.navigateToMiniProgram && (this.isAndroid || !isMiniProgram))\n        wx.navigateToMiniProgram({\n            appId: appId,\n            path: '',\n            success(res) {\n                console.log(\"打开成功\");\n                // 打开成功\n            }\n        })\n    else if (wx.previewImage)\n        this.previewImage();\n}\n\nproto.previewImage = function () {\n    if (!CC_WECHATGAME) return\n    let self = this;\n    if (self.moreGameQRCodeList.length === 0)\n        self.getMoreGameQRCodeData()\n            .then(res => { self.moreGameQRCodeList = res.data.data; self.previewImage() })\n    else {\n        self.moreGameQRCodeIdx++\n        let idx = self.moreGameQRCodeIdx % self.moreGameQRCodeList.length\n        wx.previewImage({\n            urls: [self.moreGameQRCodeList[idx].QRCode]\n        });\n    }\n}\n\nmodule.exports = wechatgame"]}