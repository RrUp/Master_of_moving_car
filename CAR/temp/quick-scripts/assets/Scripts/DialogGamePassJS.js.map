{"version":3,"sources":["DialogGamePassJS.js"],"names":["GameDataManager","require","define","ShareManager","AdsManager","cc","Class","extends","Component","properties","m_dialog","Node","m_dialog_bg","Sprite","m_light_star","m_next_btn","Button","m_retry_btn","audioControl","default","onLoad","find","getComponent","start","submitScoreButtonFunc","score","log","RankKey","CC_WECHATGAME","window","wx","postMessage","messageType","MAIN_MENU_NUM","showDialog","winStarts","active","i","node","opacity","clickNextBtn","stageId","getInstance","getGameCurLevelNum","packages","getLatestPackage","playClick","getStageCount","setGameCurLevelNum","console","director","loadScene","clickRetryBtn","clickShareBtn","onShareGame"],"mappings":"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","file":"DialogGamePassJS.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["var GameDataManager = require(\"GameDataManagerJS\");\nvar define = require(\"define\");\nvar ShareManager = require(\"ShareManagerJS\");\nvar AdsManager = require(\"AdsManagerJS\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        m_dialog: cc.Node,\n        m_dialog_bg: cc.Sprite,\n        m_light_star: [cc.Sprite],\n        m_next_btn: cc.Button,\n        m_retry_btn: cc.Button,\n        // choosestage: {\n        //     type: cc.Node,\n        //     default: null\n        // },\n        audioControl:\n        {\n            default: null,\n        }\n\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        this.audioControl = cc.find('AudioControlNode').getComponent('AudioSourceControl');\n        // var canvas = this.m_dialog;\n        // var self = this;\n        // var playerStart = GameDataManager.getInstance().getGameCompleteStars()\n        // this.submitScoreButtonFunc(playerStart)\n        //停止触摸动作\n        // canvas.on(cc.Node.EventType.TOUCH_START, function (event) {\n        //     event.stopPropagation();\n        // }, self.node);\n        // canvas.on(cc.Node.EventType.TOUCH_MOVE, function (event) {\n        //     event.stopPropagation();\n        // }, self.node);\n        // canvas.on(cc.Node.EventType.TOUCH_END, function (event) {\n        //     event.stopPropagation();\n        // }, self.node);\n    },\n\n    start() {\n    },\n\n    // update (dt) {},\n    //提交分数\n    submitScoreButtonFunc(score) {\n        cc.log(\"gamepass 提交\" + score + \"key=\" + define.RankKey);\n        if (CC_WECHATGAME) {\n            window.wx.postMessage({\n                messageType: 3,\n                MAIN_MENU_NUM: define.RankKey,\n                score: score,\n            });\n        } else {\n            cc.log(\"fail 提交得分 : \" + score)\n        }\n    },\n    showDialog: function (winStarts) {\n        this.m_dialog.active = true;\n        // AdsManager.getInstance().showBannerAD();\n        //星星个数展示\n        for (var i = 0; i < winStarts; i++) {\n            this.m_light_star[i].node.opacity = 255;\n        }\n        // var titleList = [\"label_good.png\", \"label_great.png\", \"label_excellent.png\"];\n        // var urlPath = cc.url.raw(\"resources/\" + GameDataManager.getInstance().getResName(titleList[winStarts - 1]));\n        // this.m_dialog_title.spriteFrame = new cc.SpriteFrame(urlPath);\n\n        {\n            // var self = this;\n            // //btn more game\n            // if (CC_WECHATGAME) {\n            //     //loading 中未加载\n            //     urlPath = GameDataManager.getInstance().getResName('btn_show_more_game')\n            //     cc.loader.loadRes(urlPath, cc.SpriteFrame, function (err, res) {\n            //         if (err)\n            //             console.log('Completed with ' + err.length + ' errors');\n            //         else {\n            //             //console.log(' btn more game 加载完成！' + res._name + '  ');\n            //             self.m_MoreGame_btn.normalSprite = res;\n            //             self.m_MoreGame_btn.pressedSprite = res;\n            //             self.m_MoreGame_btn.hoverSprite = res;\n\n            //             var act1 = cc.scaleTo(1.0, 0.8);\n            //             var act2 = cc.scaleTo(1.0, 1.2);\n            //             var seq = cc.sequence(act1, act2);\n            //             self.m_MoreGame_btn.node.runAction(cc.repeatForever(seq));\n            //         }\n            //     });\n\n            //     urlPath = GameDataManager.getInstance().getResName('adornment_addToMiniProgram')\n            //     cc.loader.loadRes(urlPath, cc.SpriteFrame, function (err, res) {\n            //         if (err)\n            //             console.log('Completed with ' + err.length + ' errors');\n            //         else {\n            //             self.m_addToMiniProgram.spriteFrame = res;\n            //         }\n            //     });\n            //     var rotateTo1 = cc.rotateTo(0.5, 15.0);\n            //     var rotateTo2 = cc.rotateTo(0.5, 0.0);\n            //     var rotateTo3 = cc.rotateTo(0.5, -15.0);\n            //     var rotateTo4 = cc.rotateTo(0.5, 0.0);\n            //     var seq = cc.sequence(rotateTo1, rotateTo2, rotateTo3, rotateTo4);\n            //     self.m_addToMiniProgram.node.runAction(cc.repeatForever(seq));\n\n            //     this.setBtnOtherSubGame()\n            // } else {\n            //     self.m_MoreGame_btn.active = false;\n            //     self.m_addToMiniProgram.node.active = false;\n            // }\n        }\n    },\n    //下一关卡\n    clickNextBtn: function () {\n        var stageId = GameDataManager.getInstance().getGameCurLevelNum() + 1;\n        var packages = GameDataManager.getInstance().getLatestPackage();\n        this.playClick();\n        if (stageId < GameDataManager.getInstance().getStageCount(packages)) {\n            GameDataManager.getInstance().setGameCurLevelNum(stageId);\n\n            console.log(' enterGameSceneCallback  unlcok =', stageId);\n            cc.director.loadScene(\"game\");\n        } else {\n            cc.director.loadScene(\"ChooseStageScene\");\n            console.log(' was   Latest  stageId ！！！');\n        }\n    },\n    //重玩\n    clickRetryBtn: function () {\n        this.playClick();\n        cc.director.loadScene(\"game\");\n    },\n    //炫耀一下\n    clickShareBtn: function () {\n        this.playClick();\n        ShareManager.getInstance().onShareGame(\"sharePic\");\n        // // cc.director.loadScene(\"GamePlayScene\");\n    },\n    playClick: function () {\n        if (this.audioControl) {\n            this.audioControl.playClick();\n        }\n    },\n});\n"]}