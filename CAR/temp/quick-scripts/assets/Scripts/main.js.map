{"version":3,"sources":["main.js"],"names":["define","require","AdsManager","ShareManager","GameDataManager","cc","Class","extends","Component","properties","background","Sprite","title_bg","gold_btn","Button","audio_btn","share_btn","moregame_btn","begin_btn","rank_btn","skin_btn","rankNode","Node","skinNode","gold_lab","Label","gameBox","onLoad","can","find","getComponent","Canvas","winSize","width","height","designScreen","fitHeight","fitWidth","alignWithScreen","DesignResolutionSize","view","getDesignResolutionSize","WinSize","director","getWinSize","nodeX","nodeY","visibleRect","getVisibleSize","kWH","kMoveHight","console","log","offsetk","node","getPosition","y","setPosition","sys","platform","IPHONE","size","getFrameSize","isIphoneX","cvs","audioControl","mute","AudioSource","carskin","getInstance","getcarskin","coin","getgold","money","string","on","updatemoney","start","active","playAudio","playerStart","getGameCompleteStars","submitScoreButtonFunc","score","RankKey","CC_WECHATGAME","window","wx","postMessage","messageType","MAIN_MENU_NUM","update","dt","gold_btnClick","playClick","savegold","emit","gold_btnCallback","audio_btnClick","music","volume","self","urlPath","loader","loadRes","SpriteFrame","err","spriteFrame","normalSprite","pressedSprite","hoverSprite","length","other_btnClick","moregame_btnClick","begin_btnClick","loadScene","share_btnClick","main","text","getTextById","onShareGame","rank_btnClick","rank","skin_btnClick","skin","back_btnClick"],"mappings":"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","file":"main.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["var define = require(\"define\");\nvar AdsManager = require(\"AdsManagerJS\");\nvar ShareManager = require(\"ShareManagerJS\");\nvar GameDataManager = require(\"GameDataManagerJS\");\n\ncc.Class({\n  extends: cc.Component,\n\n  properties: {\n    background: cc.Sprite,\n    title_bg: cc.Sprite,\n    gold_btn: cc.Button,\n    audio_btn: cc.Button,\n    share_btn: cc.Button,\n    moregame_btn: cc.Button,\n    begin_btn: cc.Button,\n    rank_btn: cc.Button,\n    skin_btn: cc.Button,\n    rankNode: cc.Node,\n    skinNode: cc.Node,\n    gold_lab: cc.Label,\n    gameBox: cc.Node,\n  },\n\n  // LIFE-CYCLE CALLBACKS:\n\n  onLoad() {\n    // GameDataManager.getInstance().adapt(this.node)\n    let can = cc.find(\"Canvas\").getComponent(cc.Canvas);\n    cc.winSize.width / cc.winSize.height <= (750 / 1334).designScreen ? (can.fitHeight = false, can.fitWidth = true) : (can.fitHeight = true, can.fitWidth = false);\n    can.alignWithScreen();\n    var DesignResolutionSize = cc.view.getDesignResolutionSize();\n    var WinSize = cc.director.getWinSize();\n    var nodeX = WinSize.width / DesignResolutionSize.width;\n    var nodeY = WinSize.height / DesignResolutionSize.height;\n\n    var visibleRect = cc.view.getVisibleSize();\n    var kWH = visibleRect.width / visibleRect.height;\n    var kMoveHight = (kWH - 750 / 1334)\n    console.log(\"  k= \" + 750 / 1334 + \" kWH= \" + kWH);\n    if (kMoveHight > 0) {\n      //    data.TitlePos = cc.p(width * 0.5, height * 0.9);\n    } else {\n      var offsetk = 400;\n      var begin_btn = this.begin_btn.node.getPosition();\n      begin_btn.y -= (-kMoveHight) * offsetk;\n      this.begin_btn.node.setPosition(begin_btn);\n      console.log(\"begin_btn - \" + (-kMoveHight) * offsetk);\n    }\n    //iPhoneX适配\n    if (cc.sys.platform == cc.sys.IPHONE) {\n      var size = cc.view.getFrameSize();\n      var isIphoneX = (size.width == 2436 && size.height == 1125)\n        || (size.width == 1125 && size.height == 2436);\n      if (isIphoneX) {\n        var cvs = this.node.getComponent(cc.Canvas);\n        cvs.fitHeight = true;\n        cvs.fitWidth = true;\n      }\n    }\n    this.audioControl = cc.find('AudioControlNode').getComponent('AudioSourceControl');\n    this.mute = cc.find('AudioControlNode/AudioRes/audio').getComponent(cc.AudioSource);\n    let carskin = GameDataManager.getInstance().getcarskin();\n    define.carskin = carskin;\n    let coin = GameDataManager.getInstance().getgold();\n    define.money = coin;\n    this.gold_lab.string = define.money;\n    this.node.on(\"updatemoney\", () => {\n      this.updatemoney();\n    });\n  },\n  updatemoney() {\n    this.gold_lab.string = define.money;\n  },\n  start() {\n    this.rankNode.active = false;\n    this.skinNode.active = false;\n    this.playAudio();\n    var playerStart = GameDataManager.getInstance().getGameCompleteStars();\n    this.submitScoreButtonFunc(playerStart);//提交分数\n  },\n  submitScoreButtonFunc(score) {\n    console.log(\" main  提交 : \" + score + \" key= \" + define.RankKey)\n\n    if (CC_WECHATGAME) {\n      window.wx.postMessage({\n        messageType: 3,\n        MAIN_MENU_NUM: define.RankKey,\n        score: score,\n      });\n    } else {\n      console.log(\"不支持 提交得分 : \" + score)\n    }\n  },\n  update(dt) {\n    // this.gold_lab.string = define.money;\n  },\n  gold_btnClick() {\n    this.playClick();\n    //去看视频\n    // AdsManager.getInstance().showmainRewardedGold();\n    define.money += 50;\n    GameDataManager.getInstance().savegold(define.money);\n    this.node.emit(\"updatemoney\");\n  },\n  gold_btnCallback() {\n    define.money += 50;\n    GameDataManager.getInstance().savegold(define.money);\n    this.node.emit(\"updatemoney\");\n  },\n  audio_btnClick() {\n    this.playClick();\n    if (define.music == true) {\n      define.music = false;\n      this.mute.volume = 0;\n      var self = this;\n      var urlPath = (\"mute\");\n      cc.loader.loadRes(urlPath, cc.SpriteFrame, function (err, spriteFrame) {\n        self.audio_btn.normalSprite = spriteFrame;\n        self.audio_btn.pressedSprite = spriteFrame;\n        self.audio_btn.hoverSprite = spriteFrame;\n      });\n    } else {\n      define.music = true;\n      this.mute.volume = 1;\n      var self = this;\n      var urlPath = (\"music\");\n      cc.loader.loadRes(urlPath, cc.SpriteFrame, function (err, spriteFrame) {\n        if (err)\n          cc.log('Completed with ' + err.length + ' errors');\n        else {\n          self.audio_btn.normalSprite = spriteFrame;//传图\n          self.audio_btn.pressedSprite = spriteFrame;//\n          self.audio_btn.hoverSprite = spriteFrame;//\n\n        }\n      });\n\n    }\n  },\n  other_btnClick() {\n    this.playClick();\n  },\n  moregame_btnClick() {\n    this.playClick();\n    // ShareManager.getInstance().NavigateTo7cGameBox();\n    // this.gameBox.runAction(cc.moveBy(0.5,cc.v2(0,0)));\n    // this.box=cc.find(\"Canvas/gameBox\").getComponent(\"exported-GameBoxInterface\");\n    // this.box.show();\n  },\n  begin_btnClick() {\n    this.playClick();\n    // cc.director.loadScene('SelectDifficultScene');\n    cc.director.loadScene('ChooseStageScene');\n  },\n  share_btnClick() {\n    this.playClick();\n    this.main = cc.find('Canvas/main');\n    // this.main.active = false;\n    var text = GameDataManager.getInstance().getTextById(17)\n    ShareManager.getInstance().onShareGame(\"sharePic\");\n\n  },\n\n  rank_btnClick() {\n    this.playClick();\n    this.main = cc.find('Canvas/main');\n    this.main.active = false;\n    this.rank = cc.find('Canvas/rankNode');\n    this.rank.active = true;\n  },\n  skin_btnClick() {\n    this.main = cc.find('Canvas/main');\n    this.main.active = false;\n    this.skin = cc.find('Canvas/skinNode');\n    this.skin.active = true;\n    this.playClick();\n  },\n  back_btnClick() {\n    cc.director.loadScene('main')\n    this.playClick();\n  },\n  playClick: function () {\n    if (this.audioControl) {\n      this.audioControl.playClick();\n    }\n    // AdsManager.getInstance().hideBannerAD();\n  },\n  playAudio: function () {\n    if (this.audioControl) {\n      this.audioControl.playAudio();\n    }\n  },\n\n\n});\n"]}