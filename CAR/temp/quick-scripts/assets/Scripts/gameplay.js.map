{"version":3,"sources":["gameplay.js"],"names":["define","require","Block","GameDataManager","MyLayoutManager","ShareManager","AdsManager","HintNode","cc","Class","properties","position","move","prev","index","statics","count","ctor","extends","Component","m_Gridiron","m_pPanda","Node","m_pBlocks","m_History","m_GridironSize","m_GameScaleY","m_GridSize","Size","curDate","m_MinSteps","m_Package","m_stage","m_HintBlockDestCoordinate","m_CurrentHintIndex","m_lastHints","m_HintMode","m_SolutionMoves","m_pHintBlock","default","type","bg_sprite","Sprite","menu_btn","Button","back_menu_btn","stage_btn","main_btn","sub_gameTitle","stageIdLab","Label","stageTitleLab","gold_btn","time","node","timeLab","gamepass","gameCenter","gameBtnNode","m_pHint","m_pVideoHint","m_pRetry","m_pGuideHintDest","m_pGuideHintPointer","audio","AudioSource","audioClick","audioMove","audioComplete","audioControl","m_kOffsetScale","m_DraggedMinX","m_DraggedMaxX","m_DraggedMinY","m_DraggedMaxY","gold_lab","onLoad","Date","find","getComponent","init","on","updatemoney","i","string","money","getInstance","getLatestPackage","getGameCurLevelNum","getTextById","getGridironSize","visibleRect","getVisibleRect","visibleCenter","origin","size","kWH","width","height","kHW","scaleY","kOffsetHW","gameRectWidth","getHorizontalGridironPadding","gameRectHeight","console","log","kOffsetRedress","setScale","GRIDIRON_WIDTH","setGridSize","rectX","x","getPosition","rectY","y","m_GameRect","Rect","curLevelData","getStageData","minmove","m_BlockData","length","coordinate","state","addBlock","kOrientation_Horizontal","kOrientation_Vertical","sys","isNative","platform","IPHONE","view","getFrameSize","isIphoneX","cvs","Canvas","fitHeight","fitWidth","orientation","panda","id","urlPath","blockNode","addComponent","gameLayout","addChild","pBlock","data","setId","gPosition","Vec2","isOccupiedBlock","push","setOnBlockListener","setPosition","setGPosition","updateGridiron","isOccupiedPos","isOccupiedGpos","gpos","getOrientation","t","getLength","getGPosition","j","parseInt","DEBUG_MODE","DEBUG_SHOW_MAP","res","Array","temp","pos","Math","min","max","onDragged","event","minX","maxX","getAbsolutePosition","minY","maxY","newGpos","DEBUG_SHOW_POS","touches","getTouches","touchLoc","getLocation","getId","onMove","touch","newPosition","movePosition","getTouchBeganPosition","getStartLocation","getContentSize","s_CurrentTouchedBlock","m_State","kBlockState_Grabbed","kBlockState_Ungrabbed","m_OnBlockListener","onDrop","setBlockPosition","diff","getTouchBeganGPosition","unshift","steps","showHint","updateHint","playMove","checkComplete","playComplete","onGameComplete","getLastGPosition","stopActionByTag","kMoveActionTag","stopAllActions","active","savegold","emit","getGameState","m_Mode","GameMode_Relax","winStarNum","lastStars","saveGameState","showCompleteView","addGoals","goals","dialogGamePass","showDialog","start","getIsFistPlay","getGamePlaySceneReload","setGamePlaySceneReload","director","loadScene","scheduleOnce","startFindSolution","queue","record","Set","gridironW","gridironH","current","solutionIndex","base","EXIT_Flag","newNode","add","gridiron","lastMoveBlockId","p","offset","maxRightStep","step","b1","b2","has","tempNode","encodeMove","kDirection_Right","kDirection_Left","kDirection_Up","kDirection_Down","tempArr","startShowHints","direction","clear","dest","spriteFrame","action","blink","setTag","kBlinkActionTag","runAction","repeatForever","designSize","self","loader","loadRes","SpriteFrame","err","getHintDestFrameName","gpDest","pointerRotation","offsetResolutionSize","getVisibleSize","hideAction","hide","positionDest","centerOffset","getScaleX","getScaleY","Scale","getGridSize","showAction","show","actionBlick","guideHintPointerPos","clone","setRotation","opacity","action1","moveTo","action2","fadeOut","action3","fadeIn","action4","sequence","getHintCallback","playClick","getCurrentTouchedBlock","getgold","gold_btnClick","gold_btnCallback","videohint_btnClick","videohint_btnCallback","add_touch_listeners","canvas","EventType","TOUCH_START","TOUCH_MOVE","TOUCH_END","update","dt","secondTime","getPassTime","minuteTime","hourTime","getNowTime","testDate","getTime","nowDate","passTime","passtime","menu_btnClick","back_menu_btnClick","stage_btnClick","main_btnClick","retryCallback"],"mappings":"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","file":"gameplay.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["var define = require(\"define\");\nvar Block = require(\"BlockJS\");\nvar GameDataManager = require(\"GameDataManagerJS\");\nvar MyLayoutManager = require(\"MyLayoutManagerJS\");\nvar ShareManager = require(\"ShareManagerJS\");\nvar AdsManager = require(\"AdsManagerJS\");\n\nvar HintNode = cc.Class({\n    properties: {\n        position: 0,\n        move: 0,\n        prev: 0,\n        index: 0,\n    },\n    statics: {\n        count: 0,\n    },\n    ctor(position, move, prev) {\n        this.position = position;\n        this.move = move;\n        this.prev = prev;\n        this.index = HintNode.count++;\n    },\n\n});\n\n\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        m_Gridiron: [0],\n        m_pPanda: cc.Node,\n        m_pBlocks: [cc.Node],\n        m_History: [0],\n\n        m_GridironSize: 0,\n        m_GameScaleY: 1,\n        m_GridSize: cc.Size,\n\n        curDate: 0,\n        m_MinSteps: 1,\n        m_Package: 0,\n        m_stage: 0,\n        m_HintBlockDestCoordinate: 0,\n        m_CurrentHintIndex: -1,\n        m_lastHints: 0,\n\n        m_HintMode: false,\n        m_SolutionMoves: [0],\n\n        m_pHintBlock: {\n            default: null,\n            type: cc.Block\n        },\n        bg_sprite: cc.Sprite,\n        menu_btn: cc.Button,\n        back_menu_btn: cc.Button,\n        stage_btn: cc.Button,\n        main_btn: cc.Button,\n        sub_gameTitle: cc.Sprite,\n        stageIdLab: cc.Label,\n        stageTitleLab: cc.Label,\n        gold_btn: cc.Button,\n\n        time: cc.node,\n        timeLab: cc.Label,\n\n        gamepass: cc.Node,\n        gameCenter: cc.Node,\n\n        gameBtnNode: cc.Node,\n        m_pHint: cc.Button,\n        m_pVideoHint: cc.Button,\n        m_pRetry: cc.Button,\n        // m_share_btn: cc.Button,\n\n        m_pGuideHintDest: cc.Sprite,\n        m_pGuideHintPointer: cc.Sprite,\n\n        audio: {\n            type: cc.AudioSource,\n            default: null\n        },\n        audioClick: {\n            type: cc.AudioSource,\n            default: null\n        },\n        audioMove: {\n            type: cc.AudioSource,\n            default: null\n        },\n        audioComplete: {\n            type: cc.AudioSource,\n            default: null\n        },\n        audioControl:\n        {\n            default: null,\n        },\n        m_kOffsetScale: 1,\n\n        m_DraggedMinX: 0.0,\n        m_DraggedMaxX: 0.0,\n        m_DraggedMinY: 0.0,\n        m_DraggedMaxY: 0.0,\n\n        gold_lab: cc.Label,\n\n\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        // let can = cc.find(\"Canvas\").getComponent(cc.Canvas);\n        // cc.winSize.width / cc.winSize.height <= (750 / 1334).designScreen ? (can.fitHeight = false, can.fitWidth = true) : (can.fitHeight = true, can.fitWidth = false);\n        // can.alignWithScreen();\n        // GameDataManager.getInstance().adapt(this.node);\n\n        this.curDate = new Date();\n        this.audioControl = cc.find('AudioControlNode').getComponent('AudioSourceControl');\n        this.init();\n        this.node.on(\"updatemoney\", () => {\n            this.updatemoney();\n        });\n\n    },\n    init() {\n        for (var i = 0; i < 8; ++i) {\n            this.m_Gridiron[i] = 0;\n        }\n        this.gold_lab.string = define.money;\n        this.m_Package = GameDataManager.getInstance().getLatestPackage();\n        this.m_stage = GameDataManager.getInstance().getGameCurLevelNum();\n        this.stageIdLab.string = GameDataManager.getInstance().getTextById(12) + (this.m_stage + 1);//关卡1\n\n        this.m_GridironSize = MyLayoutManager.getInstance().getGridironSize();\n        var visibleRect = MyLayoutManager.getInstance().getVisibleRect();\n        var visibleCenter = visibleRect.origin + visibleRect.size / 2;\n        var kWH = visibleRect.size.width / visibleRect.size.height;\n        var kHW = visibleRect.size.height / visibleRect.size.width;\n        var scaleY = visibleRect.size.height / 1334;\n        var kOffsetHW = kHW / (1334 / 750.0)\n        // var gameRectWidth = visibleRect.size.width - MyLayoutManager.getInstance().getHorizontalGridironPadding() * 2;// visibleRect.size.width - MyLayoutManager.getInstance().getHorizontalGridironPadding() * 2;\n       \n        var gameRectWidth = this.gameCenter.width - MyLayoutManager.getInstance().getHorizontalGridironPadding() * 2;\n         var gameRectHeight = gameRectWidth;\n         // var gameRectHeight = this.gameCenter.height - MyLayoutManager.getInstance().getHorizontalGridironPadding() * 10 * 2;\nconsole.log(\"=====kOffsetHW\",kOffsetHW)\n\n            //高宽比 较小的\n            if (kOffsetHW < 0.75) {\n                //pad\n                var kOffsetRedress = 1.3\n                this.m_kOffsetScale = kOffsetHW * kOffsetRedress\n                gameRectWidth = gameRectWidth * (this.m_kOffsetScale);\n                gameRectHeight *= (this.m_kOffsetScale);\n                this.gameCenter.setScale(this.m_kOffsetScale);\n            } else\n                if (kOffsetHW < 0.9) {\n                    //pad\n                    var kOffsetRedress = 1.10\n                    this.m_kOffsetScale = kOffsetHW * kOffsetRedress\n                    gameRectWidth = gameRectWidth * (this.m_kOffsetScale);\n                    gameRectHeight *= (this.m_kOffsetScale);\n                    this.gameCenter.setScale(this.m_kOffsetScale);\n                } else if (kOffsetHW < 0.95) {\n                    //pad\n                    var kOffsetRedress = 1.04\n                    this.m_kOffsetScale = kOffsetHW * kOffsetRedress\n                    gameRectWidth = gameRectWidth * (this.m_kOffsetScale);\n                    gameRectHeight *= (this.m_kOffsetScale);\n                    this.gameCenter.setScale(this.m_kOffsetScale);\n                }\n\n                // this.gameCenter.setScale(0.5);\n\n        this.m_GridironSize.width = this.m_GridironSize.height = define.GRIDIRON_WIDTH;\n        this.m_GridSize.width = gameRectWidth / this.m_GridironSize.width;\n        this.m_GridSize.height = gameRectHeight / this.m_GridironSize.height;\n        MyLayoutManager.getInstance().setGridSize(this.m_GridSize);\n        var rectX = visibleRect.origin.x + visibleRect.size.width * 0.5 + this.gameCenter.getPosition().x - gameRectWidth * 0.5\n        var rectY = visibleRect.origin.y + visibleRect.size.height * 0.5 + this.gameCenter.getPosition().y - gameRectHeight * 0.5 - 10\n        this.m_GameRect = new cc.Rect(rectX, rectY, gameRectWidth, gameRectHeight);\n        var curLevelData = GameDataManager.getInstance().getStageData(this.m_Package, this.m_stage);\n        this.m_MinSteps = curLevelData.minmove;\n        for (var i = 0; i < curLevelData.m_BlockData.length; i++) {\n            var coordinate = curLevelData.m_BlockData[i].coordinate;\n            var state = curLevelData.m_BlockData[i].state;\n            this.addBlock((coordinate & 0xF0) >> 4, coordinate & 0x0F, (state & 0x20) ? define.kOrientation_Horizontal : define.kOrientation_Vertical, state & 0x0F, (state & 0x10) != 0);\n        }\n          //iPhoneX适配\n     if(cc.sys.isNative && cc.sys.platform == cc.sys.IPHONE){\n        var size = cc.view.getFrameSize();\n        var isIphoneX = (size.width == 2436 && size.height == 1125) \n               ||(size.width == 1125 && size.height == 2436);\n        if(isIphoneX){\n            var cvs = this.node.getComponent(cc.Canvas);\n            cvs.fitHeight = true;\n            cvs.fitWidth = true;\n        }\n    }\n    },\n    addBlock(x, y, orientation, length, panda) {\n        var id = 0;\n        if (orientation == define.kOrientation_Horizontal) {\n            y = this.m_GridironSize.height - 1 - y;\n        }\n        else if (orientation == define.kOrientation_Vertical) {\n            y = this.m_GridironSize.height - length - y;\n        }\n        if (id <= 0) {\n            id = this.m_pBlocks.length + 1;\n        }\n        var urlPath = (\"resources/car1.png\");\n        var blockNode = new cc.Node('Sprite');\n        blockNode.addComponent(cc.Sprite);\n        var gameLayout = cc.find(\"Canvas/gameplay/gameCenterNode\");\n        gameLayout.addChild(blockNode);\n\n        var pBlock = blockNode.addComponent('BlockJS');\n        var data = { orientation: 0, length: 0, panda: true };\n        data.orientation = orientation;\n        data.length = length;\n        data.panda = panda;\n\n        blockNode.getComponent('BlockJS').init(data);\n        blockNode.getComponent('BlockJS').setId(id);\n        var gPosition = new cc.Vec2(x, y);\n        if (!this.isOccupiedBlock(pBlock, gPosition)) {\n            this.m_pBlocks.push(blockNode);\n            blockNode.getComponent('BlockJS').setOnBlockListener(this);\n            blockNode.getComponent('BlockJS').setPosition(this.getPosition(gPosition));\n            blockNode.getComponent('BlockJS').setGPosition(gPosition);\n            this.updateGridiron();\n            if (panda) {\n                this.m_pPanda = blockNode.getComponent(\"BlockJS\");\n            }\n            return true;\n        }\n        return false;\n    },\n    isOccupiedPos: function (x, y) {\n        if (x >= 0 && y >= 0 && x < this.m_GridironSize.width && y < this.m_GridironSize.height) {\n            return ((this.m_Gridiron[y] & (0x1 << x)) != 0);\n        }\n        else {\n            return true;\n        }\n    },\n    isOccupiedGpos: function (gpos) {\n        return this.isOccupiedPos(gpos.x, gpos.y);\n    },\n    isOccupiedBlock: function (pBlock, gpos) {\n        var orientation = pBlock.getOrientation();\n        if (orientation == define.kOrientation_Horizontal) {\n            var t = new cc.Vec2(gpos.x, gpos.y);\n            for (var i = 0; i < pBlock.getLength(); i++ , t.x++) {\n                if (this.isOccupiedGpos(t)) {\n                    return true;\n                }\n            }\n        } else if (orientation == define.kOrientation_Vertical) {\n            var t = new cc.Vec2(gpos.x, gpos.y);\n            for (var i = 0; i < pBlock.getLength(); i++ , t.y++) {\n                if (this.isOccupiedGpos(t)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    },\n    updateGridiron: function () {\n        for (var i = 0; i < this.m_Gridiron.length; i++) {\n            this.m_Gridiron[i] = 0;\n        }\n\n        for (var i = 0; i < this.m_pBlocks.length; i++) {\n            var blockNode = this.m_pBlocks[i];\n            var pBlock = blockNode.getComponent('BlockJS')\n\n            var orientation = pBlock.getOrientation();\n            var gPosition = pBlock.getGPosition();\n\n            if (gPosition.x >= 0 && gPosition.y >= 0) {\n                if (orientation == define.kOrientation_Horizontal) {\n                    for (var j = 0; j < pBlock.getLength(); j++) {\n                        this.m_Gridiron[parseInt(gPosition.y)] |= (0x1 << parseInt(gPosition.x + j))\n                    }\n                }\n                else if (orientation == define.kOrientation_Vertical) {\n                    for (var j = 0; j < pBlock.getLength(); j++) {\n                        this.m_Gridiron[parseInt(gPosition.y + j)] |= (0x1 << parseInt(gPosition.x));\n                    }\n                }\n            }\n        }\n\n        if (define.DEBUG_MODE && define.DEBUG_SHOW_MAP) {\n            console.log(\"*************begin to print*************\\n\");\n            var res = new Array();\n            for (var i = this.m_GridironSize.height - 1; i >= 0; i--) {\n                for (var j = 0; j < this.m_GridironSize.width; j++) {\n                    res[j] = (this.m_Gridiron[i] & (0x1 << j)) ? 'x' : '.';\n                }\n                res[parseInt(this.m_GridironSize.width)] = 0;\n\n                var temp = new Array();\n                for (var j = 0; j < this.m_GridironSize.width; j++) {\n                    temp += res[j];\n                }\n                console.log(i + \" \" + temp);\n            }\n            console.log(\"*************end print*************\\n\");\n        }\n    },\n    getPosition: function (gPosition) {\n        var pos = new cc.Vec2(this.m_GameRect.origin.x + gPosition.x * this.m_GridSize.width, this.m_GameRect.origin.y + gPosition.y * this.m_GridSize.height);\n        return pos;\n    },\n\n    getGPosition: function (position) {\n        var x = (position.x - this.m_GameRect.origin.x) / this.m_GridSize.width;//在第x个格子\n        x = parseInt(x + (x > 0 ? 0.5 : -0.5));\n        x = Math.min(Math.max(0, x), this.m_GridironSize.width - 1);\n\n        var y = (position.y - this.m_GameRect.origin.y) / this.m_GridSize.height;\n        y = parseInt(y + (y > 0 ? 0.5 : -0.5));\n        y = Math.min(Math.max(0, y), this.m_GridironSize.height - 1);\n\n        return new cc.Vec2(x, y);\n    },\n    onDragged: function (pBlock, event) {\n\n        if (this.m_pHintBlock && this.m_pHintBlock != pBlock) {\n            return false;\n        }\n\n        var gPosition = pBlock.getGPosition();\n        var orientation = pBlock.getOrientation();\n        if (orientation == define.kOrientation_Horizontal) {\n            var minX = gPosition.x;\n            var maxX = gPosition.x;\n\n            while (!this.isOccupiedPos(minX - 1, gPosition.y)) {\n                minX--;\n            }\n            while (!this.isOccupiedPos(maxX + pBlock.getLength(), gPosition.y)) {\n                maxX++;\n            }\n\n            this.m_DraggedMinX = this.m_GameRect.origin.x + minX * this.m_GridSize.width;\n            this.m_DraggedMaxX = this.m_GameRect.origin.x + maxX * this.m_GridSize.width;\n            this.m_DraggedMinY = this.m_DraggedMaxY = pBlock.getAbsolutePosition().y;\n        } else if (orientation == define.kOrientation_Vertical) {\n            var minY = gPosition.y;\n            var maxY = gPosition.y;\n\n            while (!this.isOccupiedPos(gPosition.x, minY - 1)) {\n                minY--;\n            }\n            while (!this.isOccupiedPos(gPosition.x, maxY + pBlock.getLength())) {\n                maxY++;\n            }\n\n            this.m_DraggedMinX = this.m_DraggedMaxX = pBlock.getAbsolutePosition().x;\n            this.m_DraggedMinY = this.m_GameRect.origin.y + minY * this.m_GridSize.height;\n            this.m_DraggedMaxY = this.m_GameRect.origin.y + maxY * this.m_GridSize.height;\n        }\n\n        var newGpos = new cc.Vec2(-1, -1);\n        pBlock.setGPosition(newGpos);\n\n        this.updateGridiron();\n\n        if (define.DEBUG_MODE && define.DEBUG_SHOW_POS) {\n            var touches = event.getTouches();\n            var touchLoc = touches[0].getLocation();\n            console.log(\"  car \" + pBlock.getId() + \" start\" + \"=\" + touchLoc.x + \",\" + touchLoc.y);\n            console.log(\" game onDragged =\");\n        }\n        return true;\n    },\n\n    onMove: function (pBlock, event) {\n        var touches = event.getTouches();\n        var touch = touches[0];\n        var touchLoc = touches[0].getLocation();\n        //最后终点位置\n        var newPosition = new cc.Vec2;\n        //移动\n        var movePosition = new cc.Vec2;\n        movePosition.x = pBlock.getTouchBeganPosition().x + touch.getLocation().x - touch.getStartLocation().x;\n        movePosition.y = pBlock.getTouchBeganPosition().y + touch.getLocation().y - touch.getStartLocation().y;\n\n        newPosition = new cc.Vec2(Math.min(Math.max(this.m_DraggedMinX, movePosition.x), this.m_DraggedMaxX), Math.min(Math.max(this.m_DraggedMinY, movePosition.y), this.m_DraggedMaxY))\n        //屏幕绝对坐标\n        pBlock.setPosition(newPosition);\n\n        if (define.DEBUG_MODE && define.DEBUG_SHOW_POS) {\n            console.log(\" game onMove =\");\n\n            console.log(\"  car \" + pBlock.getId() + \" move\" + \"=\" + touchLoc.x + \",\" + touchLoc.y);\n        }\n\n        if (((touchLoc.x > pBlock.getAbsolutePosition().x) && (touchLoc.x < pBlock.getAbsolutePosition().x + pBlock.getContentSize().width * 1.3)) &&\n            ((touchLoc.y > pBlock.getAbsolutePosition().y) && (touchLoc.y < pBlock.getAbsolutePosition().y + pBlock.getContentSize().height * 1.3))) {\n        } else {\n            console.log(\"  超出矩形范围  \" + touchLoc.x + \" ，\" + touchLoc.y);\n            if (Block.s_CurrentTouchedBlock != pBlock)\n                return;\n            if (pBlock.m_State == define.kBlockState_Grabbed) {\n                pBlock.m_State = define.kBlockState_Ungrabbed;\n                if (pBlock.m_OnBlockListener) {\n                    this.onDrop(pBlock, event);\n                }\n            }\n            Block.s_CurrentTouchedBlock = null;\n        }\n    },\n\n    onDrop: function (pBlock, event) {\n\n        this.setBlockPosition(pBlock, pBlock.getAbsolutePosition());\n        var diff = new cc.Vec2;\n        diff.x = pBlock.getGPosition().x - pBlock.getTouchBeganGPosition().x;\n        diff.y = pBlock.getGPosition().y - pBlock.getTouchBeganGPosition().y;\n\n        if (diff.x || diff.y) {\n            var temp = (pBlock.getId() << 24) | ((pBlock.getOrientation() == define.kOrientation_Horizontal ? parseInt(diff.x + 10) : parseInt(diff.y + 10)) << 16) | (this.m_CurrentHintIndex + 1);\n            this.m_History.unshift(temp);\n\n            var steps = this.m_History.length;\n\n            if (define.DEBUG_MODE) {\n                console.log(\" getId=  \" + pBlock.getId() + \" x= \" + diff.x + \" y= \" + diff.y + \" m_CurrentHintIndex=\" + this.m_CurrentHintIndex);\n                console.log(\" temp=  \" + temp);\n            }\n            if (this.m_pHintBlock && this.m_pHintBlock == pBlock) {\n                var coordinate = this.m_pHintBlock.getOrientation() == define.kOrientation_Horizontal ? this.m_pHintBlock.getGPosition().x : this.m_pHintBlock.getGPosition().y;\n                if (coordinate == this.m_HintBlockDestCoordinate) {\n                    this.showHint(this.m_CurrentHintIndex + 1);\n                }\n                else {\n                    this.updateHint();\n                }\n            }\n        }\n\n        this.playMove();\n\n        // AudioManager::getInstance()->playEffect(MOVE_EFFECT_FILE);\n        if (this.m_pPanda && pBlock == this.m_pPanda) {\n            if (this.checkComplete()) {\n                this.playComplete();\n                this.onGameComplete();\n            }\n        }\n\n        if (define.DEBUG_MODE && define.DEBUG_SHOW_POS) {\n            console.log(\" game onDrop =\");\n            var touches = event.getTouches();\n            var touchLoc = touches[0].getLocation();\n            console.log(\"  car \" + pBlock.getId() + \" end\" + \"=\" + touchLoc.x + \",\" + touchLoc.y);\n        }\n    },\n    setBlockPosition: function (pBlock, position) {\n        if (define.DEBUG_MODE && define.DEBUG_SHOW_POS) {\n            console.log(\"  setBlockPosition= \" + parseInt(position.x) + \",\" + parseInt(position.y));\n        }\n        var gPosition = this.getGPosition(position);\n        if (!this.isOccupiedBlock(pBlock, gPosition)) {\n            pBlock.setPosition(this.getPosition(gPosition));\n            pBlock.setGPosition(gPosition);\n            this.updateGridiron();\n        } else {\n            pBlock.setPosition(this.getPosition(pBlock.getLastGPosition()));\n        }\n    },\n    //目标车位置判断过关\n    checkComplete: function () {\n        if (this.m_pPanda && this.m_pPanda.getGPosition().x + this.m_pPanda.getLength() == this.m_GridironSize.width) {\n            return true;\n        }\n        return false;\n    },\n    onGameComplete: function () {\n        // 如果有提示，则删除提示\n        if (this.m_HintMode) {\n            this.m_pGuideHintPointer.node.stopActionByTag(define.kMoveActionTag);\n            this.m_pGuideHintDest.node.stopAllActions();\n            this.m_pGuideHintDest.node.active = false;\n            this.m_pGuideHintPointer.node.active = false;\n            this.m_HintMode = false;\n        }\n        define.money+=5;\n        GameDataManager.getInstance().savegold(define.money);\n        this.node.emit(\"updatemoney\");\n        var state = GameDataManager.getInstance().getGameState(this.m_Package, this.m_stage);\n        var steps = this.m_History.length;\n        var m_Mode = define.GameMode_Relax;\n        if (m_Mode == define.GameMode_Relax) {\n            // stars\n            var winStarNum = steps <= (this.m_MinSteps + 3) ? 3 : (steps <= (this.m_MinSteps + 10) ? 2 : 1);\n            var lastStars = state;\n            if (define.DEBUG_MODE) {\n                console.log(\"winStarNum = \" + winStarNum);\n            }\n\n            if (winStarNum > lastStars) {\n                //更新星星数目\n                GameDataManager.getInstance().saveGameState(this.m_Package, this.m_stage, winStarNum);\n                // AudioManager::getInstance()->playEffect(ADD_STAR);\n            }\n        }\n        // AudioManager::getInstance()->playEffect(COMPLETE_EFFECT_FILE);\n        this.showCompleteView(winStarNum);\n\n        GameDataManager.getInstance().addGoals()\n        // define.goals = GameDataManager.getInstance().getGoals()\n        if (define.DEBUG_MODE) {\n            console.log(\"play counts = \" + define.goals);\n        }\n    },\n    showCompleteView: function (winStarNum) {\n        this.playComplete();\n        var dialogGamePass = cc.find(\"Canvas/DialogGamePass\").getComponent('DialogGamePassJS');\n        dialogGamePass.showDialog(winStarNum)\n\n        console.log(\"popGamePassDialog \");\n    },\n\n\n    // 第一次玩  启动提示\n    start() {\n\n        if (GameDataManager.getInstance().getIsFistPlay() == true) {\n            cc.log(\"第一次玩\")\n            if (GameDataManager.getInstance().getGamePlaySceneReload() == false) {\n                GameDataManager.getInstance().setGamePlaySceneReload(true);\n                cc.director.loadScene(\"game\");\n            } else {\n                this.scheduleOnce(function () {\n                    this.startFindSolution();\n                }, 0.5);\n            }\n        }\n    },\n\n    startFindSolution() {\n        var queue = new Array();\n        var record = new Set();\n        this.m_SolutionMoves = new Array();\n        var gridironW = this.m_GridironSize.width\n        var gridironH = this.m_GridironSize.height;\n        var current = 0;\n        var solutionIndex = 0;\n        var size = this.m_pBlocks.length;\n        var position = 0;\n        var base = 1;\n\n        var EXIT_Flag = false;\n\n        for (var index = 0; index < size; index++ , base *= gridironW) {\n            var blockNode = this.m_pBlocks[index];\n            var pBlock = blockNode.getComponent('BlockJS')\n\n            position += (pBlock.getOrientation() == define.kOrientation_Horizontal ? parseInt(pBlock.getGPosition().x) : parseInt(pBlock.getGPosition().y)) * base;\n        }\n\n        var newNode = new HintNode(position, 0, null)\n        queue.push(newNode);\n        record.add(position);\n\n        var gridiron = new Array();\n\n        while (current < queue.length) {\n            var node = queue[current++];\n            var lastMoveBlockId = node.move > 0 ? node.move / 1000 : -1;\n\n            for (var i = 0; i < gridironW * gridironH; i++) {\n                gridiron[i] = 0;\n            }\n\n            // resolve position information from long int position\n            base = 1;\n\n            for (var index = 0; index < size; index++ , base *= gridironW) {\n                var blockNode = this.m_pBlocks[index];\n                var pBlock = blockNode.getComponent('BlockJS')\n\n                var p = parseInt(node.position % (base * gridironW) / base);\n\n                if (pBlock.getOrientation() == define.kOrientation_Horizontal) {\n                    var offset = pBlock.getGPosition().y * gridironW;\n                    for (var j = p; j <= p + pBlock.getLength() - 1; j++) {\n                        //  CC_ASSERT(offset + j >= 0);\n                        gridiron[offset + j] = pBlock.getId();\n                    }\n                } else {\n                    for (var j = p; j <= p + pBlock.getLength() - 1; j++) {\n                        //CC_ASSERT((int )pBlock.getGPosition().x + j * gridironH >= 0);\n                        gridiron[parseInt(pBlock.getGPosition().x + j * gridironW)] = pBlock.getId();\n                    }\n                }\n            }\n\n            base = 1;\n\n            for (var index = 0; index < size; index++ , base *= gridironW) {\n                var blockNode = this.m_pBlocks[index];\n                var pBlock = blockNode.getComponent('BlockJS')\n\n                if (pBlock.getId() == lastMoveBlockId) {\n                    continue;\n                }\n\n                var x, y;\n                if (pBlock.getOrientation() == define.kOrientation_Horizontal) {\n                    x = parseInt(node.position % (base * gridironW) / base);\n                    y = parseInt(pBlock.getGPosition().y);\n                }\n                else {\n                    x = parseInt(pBlock.getGPosition().x);\n                    y = parseInt(node.position % (base * gridironW) / base);\n                }\n\n                if (pBlock.getOrientation() == define.kOrientation_Horizontal) {\n                    var offset = y * gridironW + x;\n                    // Move Right\n                    var maxRightStep = 0;\n                    for (var step = 1; x + step + pBlock.getLength() - 1 < gridironW && gridiron[offset + step + pBlock.getLength() - 1] == 0; step++) {\n\n                        var b1 = x + step + pBlock.getLength() - 1 < gridironW;\n                        var b2 = (gridiron[offset + step + pBlock.getLength() - 1] == 0);\n                        //CC_ASSERT(offset + step + pBlock.getLength() - 1 >= 0);\n                        var newPosition = node.position + base * step;\n                        if (record.has(newPosition) == false) {\n                            var tempNode = new HintNode(newPosition, this.encodeMove(pBlock.getId(), define.kDirection_Right, x + step), node);\n                            queue.push(tempNode);\n                            record.add(newPosition);\n\n                            maxRightStep = step;\n                        }\n                    }\n                    if (this.m_pPanda && pBlock == this.m_pPanda && x + maxRightStep + pBlock.getLength() == gridironW) {\n                        solutionIndex = queue.length - 1;\n                        // goto EXIT;\n                        EXIT_Flag = true;\n                        break;\n                    }\n\n                    // Move Left\n                    for (var step = -1; x + step >= 0 && gridiron[offset + step] == 0; step--) {\n                        //    CC_ASSERT(offset + step >= 0);\n                        var newPosition = node.position + base * step;\n                        if (record.has(newPosition) == false) {\n                            var tempNode = new HintNode(newPosition, this.encodeMove(pBlock.getId(), define.kDirection_Left, x + step), node);\n                            queue.push(tempNode);\n                            record.add(newPosition);\n                        }\n                    }\n                }\n\n                else {\n                    var offset = y * gridironW + x;\n                    // Move Up\n                    for (var step = 1; y + step + pBlock.getLength() - 1 < gridironH && gridiron[offset + (step + pBlock.getLength() - 1) * gridironW] == 0; step++) {\n                        //    CC_ASSERT(offset + (step + pBlock.getLength() - 1) * gridironW >= 0);\n                        var newPosition = node.position + base * step;\n                        if (record.has(newPosition) == false) {\n                            var tempNode = new HintNode(newPosition, this.encodeMove(pBlock.getId(), define.kDirection_Up, y + step), node);\n                            queue.push(tempNode);\n                            record.add(newPosition);\n                        }\n                    }\n\n                    // Move Down\n                    for (var step = -1; y + step >= 0 && gridiron[offset + step * gridironW] == 0; step--) {\n                        //    CC_ASSERT(offset + step * gridironW >= 0);\n                        var newPosition = node.position + base * step;\n                        if (record.has(newPosition) == false) {\n                            var tempNode = new HintNode(newPosition, this.encodeMove(pBlock.getId(), define.kDirection_Down, y + step), node)\n                            queue.push(tempNode);\n                            record.add(newPosition);\n                        }\n                    }\n                }\n            }\n\n            if (EXIT_Flag == true) {\n                break;\n            }\n        }\n        // EXIT:\n        var tempArr = new Array();\n        if (solutionIndex >= 0) {\n            var node = queue[solutionIndex];\n            while (node) {\n                if (node.move != 0) {\n                    tempArr.push(node.move)\n                    this.m_SolutionMoves.unshift(node.move);\n                }\n                node = node.prev;\n            }\n\n            tempArr.length;\n            for (var i = 0; i < this.m_SolutionMoves.length; ++i) {\n            }\n\n            if (this.m_SolutionMoves.length > 0) {\n\n                this.scheduleOnce(function () {\n                    this.startShowHints();\n                }, 0);\n            }\n        }\n\n    },\n    encodeMove: function (id, direction, step) {\n        return id * 1000 + direction * 100 + step;\n    },\n\n    updatemoney() {\n        this.gold_lab.string = define.money;\n    },\n    startShowHints: function (index) {\n        this.showHint(0);\n    },\n\n    showHint: function (index) {\n        if (index < 0) {\n            this.m_HintMode = false;\n            if (this.m_pGuideHintDest) {\n                this.m_pGuideHintDest.node.active = false;\n                this.m_pGuideHintPointer = null;\n                //     removeChild(m_pGuideHintDest);\n            }\n            if (this.m_pGuideHintPointer) {\n                //     removeChild(m_pGuideHintPointer);\n                this.m_pGuideHintPointer.node.active = false;\n                this.m_pGuideHintPointer = null;\n            }\n            this.m_SolutionMoves.clear();\n            this.m_HintBlockDestCoordinate = 0;\n            this.m_CurrentHintIndex = index;\n\n            return;\n        }\n        this.m_HintMode = true;\n\n        // var iter = this.m_SolutionMoves[0];\n\n        if (index < parseInt(this.m_SolutionMoves.length)) {\n            var move = this.m_SolutionMoves[index];\n            var id = parseInt(move / 1000);\n            var dest = parseInt(move % 100);\n\n            for (var i = 0; i < this.m_pBlocks.length; i++) {\n                var blockNode = this.m_pBlocks[i];\n                var pBlock = blockNode.getComponent('BlockJS')\n\n                if (pBlock.getId() == id) {\n                    // if (this.m_pHintBlock)\n                    // {\n                    //     this.m_pHintBlock.clearHint();\n                    // }\n                    this.m_pHintBlock = pBlock;\n\n                    this.m_HintBlockDestCoordinate = dest;\n                    this.m_CurrentHintIndex = index;\n\n                    this.m_pGuideHintPointer.node.active = true;\n                    this.m_pGuideHintDest.node.active = true;\n                    if (this.m_pGuideHintPointer.spriteFrame == null) {\n                        var action = new cc.blink(1, 1)\n                        action.setTag(define.kBlinkActionTag);\n                        this.m_pGuideHintDest.node.runAction(new cc.repeatForever(action));\n\n                        // var urlPath = cc.url.raw(\"resources/playGamePic/hint_pointer.png\");\n                        // this.m_pGuideHintPointer.spriteFrame = new cc.SpriteFrame(urlPath);\n                        this.m_pGuideHintPointer.node.setScale(1, MyLayoutManager.getInstance().getVisibleRect().size.height / define.designSize.height);\n                        var self = this;\n                        var urlPath = (\"playGamePic/hint_pointer\");\n                        cc.loader.loadRes(urlPath, cc.SpriteFrame, function (err, spriteFrame) {\n                            self.m_pGuideHintPointer.spriteFrame = spriteFrame;\n                        });\n                    }\n\n                    this.updateHint();\n                    break;\n                }\n            }\n        }\n    },\n    //展现提示框图片\n    getHintDestFrameName: function (orientation, length) {\n        if (orientation == define.kOrientation_Horizontal) {\n            return length == 2 ? \"bk_hint_dest2h\" : \"bk_hint_dest3h\";\n        }\n        else {\n            return length == 2 ? \"bk_hint_dest2v\" : \"bk_hint_dest3v\";\n        }\n    },\n\n    updateHint: function () {\n        var step = parseInt(this.m_pHintBlock.getOrientation() == define.kOrientation_Horizontal ? this.m_HintBlockDestCoordinate - this.m_pHintBlock.getGPosition().x : this.m_HintBlockDestCoordinate - this.m_pHintBlock.getGPosition().y);\n        var gpDest = this.m_pHintBlock.getGPosition();\n\n        var pointerRotation = 0;\n        if (this.m_pHintBlock.getOrientation() == define.kOrientation_Horizontal) {\n            gpDest.x += step;\n            pointerRotation = step > 0 ? 0 : 180;\n        }\n        else {\n            gpDest.y += step;\n            pointerRotation = step > 0 ? 270 : 90;\n        }\n        var offsetResolutionSize = cc.view.getVisibleSize();\n        this.m_pGuideHintDest.node.stopActionByTag(define.kBlinkActionTag);\n        var hideAction = cc.hide();\n        this.m_pGuideHintDest.node.runAction(hideAction);\n\n        var positionDest = this.getPosition(gpDest);\n        var centerOffset = new cc.Vec2(this.m_pHintBlock.getContentSize().width * this.m_pHintBlock.getScaleX() / 2, this.m_pHintBlock.getContentSize().height * this.m_pHintBlock.getScaleY() / 2);\n\n        // var urlPath = cc.url.raw(\"playGamePic/\" + this.getHintDestFrameName(this.m_pHintBlock.getOrientation(), this.m_pHintBlock.getLength()));\n\n        // this.m_pGuideHintDest.spriteFrame = new cc.SpriteFrame(urlPath);\n        var urlPath = (\"playGamePic/\" + this.getHintDestFrameName(this.m_pHintBlock.getOrientation(), this.m_pHintBlock.getLength()));\n        var self = this;\n        cc.loader.loadRes(urlPath, cc.SpriteFrame, function (err, spriteFrame) {\n            self.m_pGuideHintDest.spriteFrame = spriteFrame;\n        });\n\n        var Scale = new cc.Vec2(MyLayoutManager.getInstance().getGridSize().width / (91 + 4), MyLayoutManager.getInstance().getGridSize().height / (91 + 4));\n        this.m_pGuideHintDest.node.setScale(Scale)\n        this.m_pGuideHintDest.node.setPosition(new cc.Vec2(positionDest.x + centerOffset.x - offsetResolutionSize.width * 0.5, positionDest.y + centerOffset.y - offsetResolutionSize.height * 0.5));\n\n        var showAction = cc.show();\n        this.m_pGuideHintDest.node.runAction(showAction);\n        var actionBlick = new cc.blink(1, 1)\n        actionBlick.setTag(define.kBlinkActionTag);\n        this.m_pGuideHintDest.node.runAction(new cc.repeatForever(actionBlick));\n\n        var guideHintPointerPos = new cc.Vec2(this.m_pHintBlock.getAbsolutePosition().x + centerOffset.x - offsetResolutionSize.width * 0.5, this.m_pHintBlock.getAbsolutePosition().y + centerOffset.y - offsetResolutionSize.height * 0.5)\n        this.m_pGuideHintPointer.node.runAction(showAction.clone());\n\n        this.m_pGuideHintPointer.node.setPosition(guideHintPointerPos);\n        this.m_pGuideHintPointer.node.setRotation(pointerRotation);\n\n        // var dest_pos=this.m_pGuideHintDest.node.getPosition()\n        // this.m_pGuideHintPointer.node.setPosition(dest_pos);\n        // this.m_pGuideHintPointer.node.active=true;\n        this.m_pGuideHintPointer.node.stopActionByTag(define.kMoveActionTag);\n        this.m_pGuideHintPointer.node.opacity = 255;\n\n        var action1 = new cc.moveTo(0.7, this.m_pGuideHintDest.node.getPosition());\n        var action2 = new cc.fadeOut(0.5);\n        var action3 = new cc.fadeIn(0.0);\n        var action4 = new cc.moveTo(0.0, this.m_pGuideHintPointer.node.getPosition());\n        var action = new cc.repeatForever(cc.sequence(action1, action2, action3, action4));\n        action.setTag(define.kMoveActionTag);\n        this.m_pGuideHintPointer.node.runAction(action);\n\n    },\n    //金币提示按钮事件\n    getHintCallback() { \n        this.playClick();\n        if (Block.getCurrentTouchedBlock()) {\n            return;\n        };\n       \n        if (this.m_HintMode) { }\n        else if (!GameDataManager.getInstance().getgold() > 0) {\n        }\n        else {\n            this.scheduleOnce(function () {\n                this.startFindSolution();\n            }, 0);\n            define.money -= 50;\n            GameDataManager.getInstance().savegold(define.money);\n            this.node.emit(\"updatemoney\");\n        }\n\n    },\n    gold_btnClick() {\n        this.playClick();\n        //去看视频\n        // AdsManager.getInstance().showRewardedGold();\n        define.money += 50;\n        GameDataManager.getInstance().savegold(define.money);\n        this.node.emit(\"updatemoney\");\n    },\n    gold_btnCallback(){\n        define.money += 50;\n        // cc.sys.localStorage.setItem(\"gold\",define.money)\n        GameDataManager.getInstance().savegold(define.money);\n        this.node.emit(\"updatemoney\");\n    },\n    videohint_btnClick() {\n        this.playClick();\n        //去看视频\n        // AdsManager.getInstance().showRewardedVideo();\n        this.scheduleOnce(function () {\n            this.startFindSolution();\n        }, 0);\n    },\n   videohint_btnCallback(){\n        this.scheduleOnce(function () {\n            this.startFindSolution();\n        }, 0);\n    },\n    //触摸监听\n    add_touch_listeners: function () {\n        var self = this;\n        var canvas = cc.find(\"Canvas\");\n\n        canvas.on(cc.Node.EventType.TOUCH_START, function (event) {\n            var touches = event.getTouches();     //touches获取触控数组\n            var touchLoc = touches[0].getLocation();//touchLoc第一个触控点的世界地图坐标（node.convertToNodeSpaceAR()可以将世界地图坐标转换为node的局部坐标）\n\n            console.log(\"  touch  start\" + \"=\" + touchLoc.x + \",\" + touchLoc.y);\n\n        }, self.node);\n\n        canvas.on(cc.Node.EventType.TOUCH_MOVE, function (event) {\n            var touches = event.getTouches();\n            var touchLoc = touches[0].getLocation();\n\n            console.log(\"  touch  move\" + \"=\" + touchLoc.x + \",\" + touchLoc.y);\n        }, self.node);\n\n        canvas.on(cc.Node.EventType.TOUCH_END, function (event) {\n            var touches = event.getTouches();\n            var touchLoc = touches[0].getLocation();\n\n            console.log(\"  touch  end\" + \"=\" + touchLoc.x + \",\" + touchLoc.y);\n        }, self.node);\n\n    },\n    //记录游戏开始时间  \n    update(dt) {\n        // this.gold_lab.string=define.money;\n        {\n            var secondTime = parseInt(this.getPassTime()); // 秒\n            var minuteTime = 0;// 分\n            var hourTime = 0;// 时\n            // var dayTime = 0;// 天\n            if (secondTime < 60) {\n                secondTime = secondTime > 9 ? secondTime : \"0\" + secondTime;\n                this.timeLab.getComponent(cc.Label).string = \"00:\" + secondTime;\n            }\n            else {\n                if (secondTime >= 60 & secondTime < 3600) {\n                    minuteTime = parseInt(secondTime / 60)\n                    secondTime = parseInt(secondTime % 60)\n                    secondTime = secondTime > 9 ? secondTime : \"0\" + secondTime;\n                    minuteTime = minuteTime > 9 ? minuteTime : \"0\" + minuteTime;\n                    this.timeLab.getComponent(cc.Label).string = minuteTime + \":\" + secondTime;\n                }\n                else if (secondTime >= 3600) {\n                    hourTime = parseInt(secondTime / 3600)\n                    minuteTime = parseInt((secondTime % 3600) / 60)\n                    secondTime = parseInt((secondTime % 3600) % 60)\n                    secondTime = secondTime > 9 ? secondTime : \"0\" + secondTime;\n                    minuteTime = minuteTime > 9 ? minuteTime : \"0\" + minuteTime;\n                    hourTime = hourTime > 9 ? hourTime : \"0\" + hourTime;\n                    this.timeLab.getComponent(cc.Label).string = hourTime + \":\" + minuteTime + \":\" + secondTime;\n                }\n            }\n        }\n    },\n    //获取当前时间\n    getNowTime() {\n        var testDate = new Date();\n        //获取当前时间(从1970.1.1开始的毫秒数)\n        cc.log(testDate);\n        return testDate.getTime();\n    },\n    //获取过去的秒数\n    getPassTime: function () {\n        var nowDate = new Date();\n        var passTime = nowDate - this.curDate;\n        // this.curDate = nowDate;\n        var passtime = passTime / 1000;\n        return passtime;\n    },\n    //菜单按钮\n    menu_btnClick() {\n        this.playClick();\n        this.menu_btn.node.active = false;\n        this.back_menu_btn.node.active = true;\n        this.main_btn.node.active = true;\n        this.stage_btn.node.active = true;\n        this.sub_gameTitle.node.active = false;\n    },\n    //返回菜单按钮\n    back_menu_btnClick() {\n        this.playClick();\n        this.menu_btn.node.active = true;\n        this.sub_gameTitle.node.active = true;\n        this.back_menu_btn.node.active = false;\n        this.main_btn.node.active = false;\n        this.stage_btn.node.active = false;\n    },\n    //进入关卡界面按钮\n    stage_btnClick() {\n        this.playClick();\n        cc.director.loadScene(\"ChooseStageScene\");\n    },\n    //进入主界面按钮\n    main_btnClick() {\n        this.playClick();\n        cc.director.loadScene(\"main\");\n\n    },\n    //重试\n    retryCallback: function () {\n        this.playClick();\n        cc.director.loadScene(\"game\");\n    },\n    //音频\n    playClick: function () {\n        if (this.audioControl) {\n            this.audioControl.playClick();\n        } else {\n        }\n    },\n    playMove: function () {\n        if (this.audioControl) {\n            this.audioControl.playMove();\n        }\n    },\n    playComplete: function () {\n        if (this.audioControl) {\n            this.audioControl.playComplete();\n        }\n    },\n\n});\n"]}